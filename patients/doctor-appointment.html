<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ù…Ø¹ Ø¯ÙƒØªÙˆØ± - Ø·Ø¨ÙŠØ¨ 24/7</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <style>
:root {
    --primary: #1e40af;
    --primary-dark: #1e3a8a;
    --primary-light: #dbeafe;
    --secondary: #dc2626;
    --accent: #f59e0b;
    --success: #059669;
    --warning: #d97706;
    --error: #dc2626;
    --dark: #1e1b4b;
    --light: #f0f9ff;
    --surface: #ffffff;
    --glass: rgba(255, 255, 255, 0.25);
    --glass-dark: rgba(255, 255, 255, 0.1);
    --text-primary: #1e293b;
    --text-secondary: #475569;
    --text-light: #64748b;
    --gradient-primary: linear-gradient(135deg, #1e40af 0%, #3730a3 100%);
    --gradient-hospital: linear-gradient(135deg, #1e40af 0%, #dc2626 100%);
    --gradient-premium: linear-gradient(135deg, #1e40af 0%, #3730a3 50%, #7c3aed 100%);
    --gradient-success: linear-gradient(135deg, #059669 0%, #10b981 100%);
    --shadow-soft: 0 8px 32px rgba(0, 0, 0, 0.1);
    --shadow-glass: 0 8px 32px rgba(30, 64, 175, 0.2);
    --shadow-card: 0 4px 24px rgba(0, 0, 0, 0.08);
    --shadow-large: 0 16px 48px rgba(0, 0, 0, 0.15);
    --radius-xl: 24px;
    --radius-lg: 20px;
    --radius-md: 16px;
    --radius-sm: 12px;
    --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Tajawal', 'El Messiri', sans-serif;
    -webkit-tap-highlight-color: transparent;
}

body {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #dbeafe 100%);
    color: var(--text-primary);
    direction: rtl;
    overflow-x: hidden;
    min-height: 100vh;
}

/* ØªØµÙ…ÙŠÙ… Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…ØªÙ…ÙŠØ² */
.status-bar {
    background: transparent;
    color: var(--text-primary);
    padding: 12px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
    font-weight: 500;
    backdrop-filter: blur(20px);
    position: relative;
    z-index: 1000;
}

.status-bar::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--glass);
    backdrop-filter: blur(20px);
    z-index: -1;
}

/* Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
.premium-app {
    max-width: 428px;
    margin: 0 auto;
    background: transparent;
    min-height: 100vh;
    position: relative;
    overflow: hidden;
}

/* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© */
.background-effects {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    pointer-events: none;
}

.floating-shapes {
    position: absolute;
    width: 100%;
    height: 100%;
}

.shape {
    position: absolute;
    border-radius: 50%;
    background: var(--gradient-primary);
    opacity: 0.1;
    animation: float 6s ease-in-out infinite;
}

.shape:nth-child(1) {
    width: 200px;
    height: 200px;
    top: 10%;
    left: 10%;
    animation-delay: 0s;
}

.shape:nth-child(2) {
    width: 150px;
    height: 150px;
    top: 60%;
    right: 20%;
    animation-delay: 2s;
}

.shape:nth-child(3) {
    width: 100px;
    height: 100px;
    bottom: 20%;
    left: 20%;
    animation-delay: 4s;
}

@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(180deg); }
}

/* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ØªÙ‚Ø¯Ù… */
.appointment-header {
    background: var(--gradient-hospital);
    color: white;
    padding: 40px 24px 30px;
    border-radius: 0 0 var(--radius-xl) var(--radius-xl);
    box-shadow: var(--shadow-glass);
    position: relative;
    overflow: hidden;
}

.header-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 1000"><polygon fill="rgba(255,255,255,0.05)" points="0,1000 1000,0 1000,1000"/></svg>');
    background-size: cover;
}

.header-content {
    position: relative;
    z-index: 2;
    text-align: center;
}

.header-title {
    font-size: 28px;
    font-weight: 800;
    margin-bottom: 8px;
    background: linear-gradient(45deg, #fff, #dbeafe);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.header-subtitle {
    font-size: 16px;
    opacity: 0.9;
    margin-bottom: 25px;
}

.quick-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 20px;
}

.stat-item {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(10px);
    border-radius: var(--radius-md);
    padding: 15px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.stat-value {
    font-size: 20px;
    font-weight: 800;
    margin-bottom: 4px;
}

.stat-label {
    font-size: 12px;
    opacity: 0.9;
}

/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
.appointment-content {
    padding: 25px 20px;
    padding-bottom: 120px;
}

.section-title {
    font-size: 20px;
    font-weight: 800;
    margin: 30px 0 20px;
    color: var(--text-primary);
    display: flex;
    align-items: center;
    gap: 12px;
    padding-right: 8px;
}

.section-title::before {
    content: '';
    width: 4px;
    height: 24px;
    background: var(--gradient-hospital);
    border-radius: 2px;
}

/* Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ø¬Ø² */
.booking-steps {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
    position: relative;
    padding: 0 10px;
}

.booking-steps::before {
    content: '';
    position: absolute;
    top: 20px;
    right: 10%;
    left: 10%;
    height: 3px;
    background: #e2e8f0;
    z-index: 1;
}

.step {
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 2;
    position: relative;
    flex: 1;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #e2e8f0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 800;
    color: var(--text-secondary);
    margin-bottom: 8px;
    transition: var(--transition-smooth);
    border: 3px solid white;
}

.step.active .step-number {
    background: var(--gradient-hospital);
    color: white;
    transform: scale(1.1);
}

.step.completed .step-number {
    background: var(--success);
    color: white;
}

.step-label {
    font-size: 12px;
    font-weight: 700;
    color: var(--text-secondary);
    text-align: center;
}

.step.active .step-label {
    color: var(--primary);
}

/* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ§Øª */
.step-content {
    display: none;
}

.step-content.active {
    display: block;
    animation: fadeIn 0.5s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ§Øª */
.step-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 30px;
    gap: 15px;
}

.btn {
    padding: 14px 24px;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 800;
    cursor: pointer;
    transition: var(--transition-bounce);
    font-size: 15px;
    display: flex;
    align-items: center;
    gap: 8px;
    min-width: 120px;
    justify-content: center;
}

.btn-primary {
    background: var(--gradient-hospital);
    color: white;
}

.btn-secondary {
    background: var(--light);
    color: var(--text-primary);
    border: 2px solid #e2e8f0;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-soft);
}

.btn:active {
    transform: translateY(0);
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
}

/* Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… */
.search-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.search-container {
    position: relative;
    margin-bottom: 20px;
}

.search-input {
    width: 100%;
    padding: 15px 50px 15px 15px;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    font-size: 16px;
    transition: var(--transition-smooth);
}

.search-input:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
}

.search-icon {
    position: absolute;
    left: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
}

.search-filters {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.filter-select {
    padding: 12px;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    font-size: 14px;
    background: white;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.filter-select:focus {
    border-color: var(--primary);
    outline: none;
}

/* Ø§Ù„ØªØ®ØµØµØ§Øª */
.specialties-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.specialties-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin-top: 20px;
}

.specialty-card {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    padding: 20px 12px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.specialty-card:hover {
    border-color: var(--primary);
    transform: translateY(-3px);
}

.specialty-card.active {
    background: var(--primary-light);
    border-color: var(--primary);
}

.specialty-icon {
    width: 50px;
    height: 50px;
    border-radius: var(--radius-md);
    background: var(--gradient-hospital);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 12px;
    font-size: 20px;
    color: white;
}

.specialty-name {
    font-weight: 700;
    font-size: 13px;
    margin-bottom: 6px;
}

.specialty-count {
    font-size: 11px;
    color: var(--text-secondary);
}

/* Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ */
.doctors-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.doctors-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 15px;
    margin-top: 20px;
}

.doctor-card {
    background: #f8fafc;
    border-radius: var(--radius-lg);
    padding: 20px;
    display: flex;
    gap: 15px;
    cursor: pointer;
    transition: var(--transition-bounce);
    border: 2px solid transparent;
}

.doctor-card:hover {
    transform: translateX(-8px);
    border-color: var(--primary);
    box-shadow: var(--shadow-soft);
}

.doctor-card.selected {
    background: var(--primary-light);
    border-color: var(--primary);
}

.doctor-avatar {
    width: 70px;
    height: 70px;
    border-radius: var(--radius-md);
    background: var(--gradient-hospital);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    color: white;
    flex-shrink: 0;
}

.doctor-info {
    flex: 1;
}

.doctor-name {
    font-weight: 800;
    font-size: 16px;
    margin-bottom: 6px;
}

.doctor-specialty {
    font-size: 14px;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.doctor-rating {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}

.stars {
    color: #f59e0b;
}

.rating-value {
    font-weight: 700;
    font-size: 14px;
}

.rating-count {
    font-size: 12px;
    color: var(--text-secondary);
}

.doctor-features {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.feature-tag {
    background: var(--primary-light);
    color: var(--primary);
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
}

.doctor-actions {
    display: flex;
    flex-direction: column;
    gap: 8px;
    justify-content: center;
}

.select-btn {
    background: var(--gradient-hospital);
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: var(--radius-md);
    font-size: 12px;
    font-weight: 700;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.select-btn:hover {
    transform: translateY(-2px);
}

.price {
    font-weight: 800;
    font-size: 14px;
    color: var(--primary);
    text-align: center;
}

/* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ù…Ø®ØªØ§Ø± */
.appointment-details-card {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 20px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 2px solid var(--primary);
}

.selected-doctor-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

/* Ø§Ù„ØªÙ‚ÙˆÙŠÙ… */
.calendar-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
}

.current-month {
    font-size: 18px;
    font-weight: 800;
    color: var(--text-primary);
}

.nav-btn {
    background: var(--light);
    border: 2px solid #e2e8f0;
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.nav-btn:hover {
    background: var(--primary-light);
    border-color: var(--primary);
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 8px;
    margin-bottom: 15px;
}

.calendar-day-header {
    text-align: center;
    font-weight: 700;
    font-size: 12px;
    color: var(--text-secondary);
    padding: 8px 0;
}

.calendar-day {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: var(--transition-smooth);
    font-weight: 600;
    font-size: 14px;
}

.calendar-day:hover {
    background: var(--primary-light);
}

.calendar-day.selected {
    background: var(--gradient-hospital);
    color: white;
    transform: scale(1.1);
}

.calendar-day.disabled {
    color: var(--text-light);
    cursor: not-allowed;
    opacity: 0.5;
}

.calendar-day.today {
    background: var(--accent);
    color: white;
}

/* Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­Ø© */
.time-slots-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.time-slots-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-top: 20px;
}

.time-slot {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    padding: 12px 8px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition-smooth);
    font-weight: 600;
    font-size: 14px;
}

.time-slot:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
}

.time-slot.selected {
    background: var(--gradient-hospital);
    color: white;
    border-color: var(--primary);
}

.time-slot.disabled {
    background: #f1f5f9;
    color: var(--text-light);
    cursor: not-allowed;
    opacity: 0.6;
}

/* Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø¬Ø² */
.appointment-summary-card {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 2px solid var(--success);
}

.summary-header {
    font-size: 18px;
    font-weight: 800;
    margin-bottom: 20px;
    color: var(--text-primary);
    text-align: center;
}

.summary-item {
    display: flex;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid #e2e8f0;
}

.summary-item:last-child {
    border-bottom: none;
}

.summary-label {
    font-weight: 600;
    color: var(--text-secondary);
}

.summary-value {
    font-weight: 700;
    color: var(--text-primary);
}

/* Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ */
.form-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.form-group {
    margin-bottom: 20px;
}

.form-label {
    display: block;
    margin-bottom: 8px;
    font-weight: 700;
    color: var(--text-primary);
    font-size: 14px;
}

.form-input, .form-select, .form-textarea {
    width: 100%;
    padding: 14px 16px;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    font-size: 16px;
    transition: var(--transition-smooth);
    background: white;
    font-family: 'Tajawal', sans-serif;
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
    border-color: var(--primary);
    outline: none;
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
}

.form-textarea {
    resize: vertical;
    min-height: 100px;
}

.form-hint {
    display: block;
    margin-top: 6px;
    font-size: 12px;
    color: var(--text-secondary);
}

/* Radio Buttons */
.radio-group {
    display: flex;
    gap: 20px;
    margin-top: 10px;
}

.radio-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-weight: 600;
}

.radio-custom {
    width: 20px;
    height: 20px;
    border: 2px solid #e2e8f0;
    border-radius: 50%;
    position: relative;
    transition: var(--transition-smooth);
}

.radio-label input {
    display: none;
}

.radio-label input:checked + .radio-custom {
    border-color: var(--primary);
    background: var(--primary);
}

.radio-label input:checked + .radio-custom::after {
    content: '';
    width: 8px;
    height: 8px;
    background: white;
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

/* Checkbox */
.checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-weight: 600;
    margin-bottom: 15px;
}

.checkbox-custom {
    width: 20px;
    height: 20px;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-sm);
    position: relative;
    transition: var(--transition-smooth);
}

.checkbox-label input {
    display: none;
}

.checkbox-label input:checked + .checkbox-custom {
    border-color: var(--primary);
    background: var(--primary);
}

.checkbox-label input:checked + .checkbox-custom::after {
    content: 'âœ“';
    color: white;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 12px;
    font-weight: bold;
}

/* Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª */
.file-upload-container {
    margin-top: 10px;
}

.file-upload-btn {
    background: var(--light);
    border: 2px dashed #e2e8f0;
    padding: 20px;
    border-radius: var(--radius-md);
    text-align: center;
    cursor: pointer;
    transition: var(--transition-smooth);
    width: 100%;
    color: var(--text-secondary);
    font-weight: 600;
}

.file-upload-btn:hover {
    border-color: var(--primary);
    background: var(--primary-light);
}

.file-list {
    margin-top: 15px;
}

.file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: #f8fafc;
    border-radius: var(--radius-sm);
    margin-bottom: 8px;
}

.file-name {
    font-size: 14px;
    font-weight: 600;
}

.file-remove {
    color: var(--error);
    cursor: pointer;
    padding: 5px;
}

/* Ø§Ù„ØªØ£Ù…ÙŠÙ† */
.insurance-section {
    background: #f8fafc;
    border-radius: var(--radius-md);
    padding: 20px;
    margin-top: 20px;
}

.insurance-details {
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px solid #e2e8f0;
}

/* Ø§Ù„Ø¯ÙØ¹ */
.payment-summary-card {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 2px solid var(--primary);
}

.appointment-number {
    background: var(--primary-light);
    color: var(--primary);
    padding: 12px;
    border-radius: var(--radius-md);
    font-family: monospace;
    font-weight: 700;
    text-align: center;
    margin: 15px 0;
    font-size: 18px;
}

.summary-item.total {
    background: #f8fafc;
    padding: 15px;
    border-radius: var(--radius-md);
    margin-top: 10px;
    border: 2px solid var(--success);
}

.summary-item.total .summary-value {
    font-size: 18px;
    color: var(--success);
}

/* Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ */
.payment-methods-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 25px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.payment-methods {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
    margin: 20px 0;
}

.payment-method {
    background: #f8fafc;
    border: 2px solid #e2e8f0;
    border-radius: var(--radius-md);
    padding: 20px 12px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition-smooth);
}

.payment-method:hover {
    border-color: var(--primary);
    transform: translateY(-3px);
}

.payment-method.active {
    background: var(--primary-light);
    border-color: var(--primary);
}

.method-icon {
    width: 50px;
    height: 50px;
    border-radius: var(--radius-md);
    background: var(--gradient-hospital);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 12px;
    font-size: 20px;
    color: white;
}

.method-name {
    font-weight: 700;
    font-size: 13px;
}

.payment-details {
    margin-top: 20px;
    padding: 20px;
    background: #f8fafc;
    border-radius: var(--radius-md);
}

.balance-info {
    background: var(--success);
    color: white;
    padding: 10px;
    border-radius: var(--radius-sm);
    text-align: center;
    font-weight: 700;
    margin-top: 10px;
}

.cash-notice {
    background: var(--warning);
    color: white;
    padding: 15px;
    border-radius: var(--radius-md);
    text-align: center;
    font-weight: 600;
}

/* Ø§Ù„Ø£Ù…Ø§Ù† */
.security-section {
    background: var(--surface);
    border-radius: var(--radius-lg);
    padding: 20px;
    box-shadow: var(--shadow-card);
    margin-bottom: 25px;
    border: 1px solid #f1f5f9;
}

.security-notice {
    display: flex;
    align-items: center;
    gap: 12px;
    justify-content: center;
    color: var(--success);
    font-weight: 700;
}

/* Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(10px);
    z-index: 2000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.modal-content {
    background: white;
    border-radius: var(--radius-xl);
    padding: 30px;
    max-width: 400px;
    width: 100%;
    box-shadow: var(--shadow-large);
    animation: modalAppear 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    max-height: 90vh;
    overflow-y: auto;
}

@keyframes modalAppear {
    from {
        opacity: 0;
        transform: scale(0.8) translateY(50px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.modal-header {
    display: flex;
    justify-content: between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid #f1f5f9;
}

.modal-title {
    font-size: 22px;
    font-weight: 800;
    color: var(--text-primary);
}

.close-modal {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: var(--text-secondary);
    transition: var(--transition-smooth);
}

.close-modal:hover {
    color: var(--error);
    transform: rotate(90deg);
}

/* ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² */
.confirmation-content {
    text-align: center;
    padding: 20px 0;
}

.success-icon {
    font-size: 64px;
    color: var(--success);
    margin-bottom: 20px;
}

.confirmation-content h3 {
    margin-bottom: 10px;
    color: var(--text-primary);
}

.confirmation-content p {
    color: var(--text-secondary);
    margin-bottom: 20px;
    line-height: 1.6;
}

.appointment-details {
    background: #f8fafc;
    border-radius: var(--radius-lg);
    padding: 20px;
    margin: 20px 0;
    text-align: right;
}

.detail-item {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px solid #e2e8f0;
}

.detail-item:last-child {
    border-bottom: none;
}

.detail-label {
    font-weight: 600;
    color: var(--text-secondary);
}

.detail-value {
    font-weight: 700;
    color: var(--text-primary);
}

.reminder-notice {
    background: var(--primary-light);
    color: var(--primary);
    padding: 15px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    gap: 10px;
    justify-content: center;
    font-weight: 600;
    margin: 20px 0;
}

.modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 25px;
}

.modal-actions .btn {
    flex: 1;
}

/* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
.bottom-nav-premium {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--glass);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    display: flex;
    padding: 15px;
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-soft);
    z-index: 1000;
    max-width: 380px;
    width: calc(100% - 40px);
}

.nav-item-premium {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px 12px;
    border-radius: var(--radius-md);
    transition: var(--transition-bounce);
    flex: 1;
    position: relative;
    text-decoration: none;
    color: inherit;
}

.nav-item-premium.active {
    background: var(--gradient-hospital);
    color: white;
    transform: translateY(-10px);
}

.nav-item-premium.active .nav-label {
    color: white;
}

.nav-item-premium.active::before {
    content: '';
    position: absolute;
    top: -8px;
    width: 20px;
    height: 3px;
    background: var(--gradient-hospital);
    border-radius: 2px;
}

.nav-icon-premium {
    font-size: 20px;
    margin-bottom: 6px;
    transition: var(--transition-smooth);
}

.nav-item-premium.active .nav-icon-premium {
    transform: scale(1.2);
}

.nav-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--text-secondary);
}

/* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
.notification {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--success);
    color: white;
    padding: 16px 24px;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-large);
    z-index: 3000;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 12px;
    animation: slideDown 0.3s ease-out;
}

.notification.error {
    background: var(--error);
}

.notification.warning {
    background: var(--warning);
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateX(-50%) translateY(-50px);
    }
    to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
    }
}

/* Ø§Ù„ØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª */
@media (max-width: 428px) {
    .specialties-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .search-filters {
        grid-template-columns: 1fr;
    }
    
    .time-slots-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .payment-methods {
        grid-template-columns: 1fr;
    }
    
    .modal-actions {
        flex-direction: column;
    }
    
    .step-actions {
        flex-direction: column;
    }
    
    .radio-group {
        flex-direction: column;
        gap: 10px;
    }
    
    .doctor-card {
        flex-direction: column;
        text-align: center;
    }
    
    .doctor-actions {
        flex-direction: row;
        justify-content: center;
    }
}
</style>
</head>
<body>
    <!-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© -->
    <div class="background-effects">
        <div class="floating-shapes">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>
    </div>

    <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© -->
    <div class="status-bar">
        <div class="status-left">
            <span id="currentTime">2:45</span>
        </div>
        <div class="status-right">
            <i class="fas fa-signal"></i>
            <i class="fas fa-wifi"></i>
            <i class="fas fa-battery-three-quarters"></i>
        </div>
    </div>

    <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="premium-app">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <div class="appointment-header">
            <div class="header-background"></div>
            <div class="header-content">
                <h1 class="header-title">Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ Ù…Ø¹ Ø¯ÙƒØªÙˆØ±</h1>
                <p class="header-subtitle">Ø§Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ Ù…Ø¹ Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ Ø§Ù„Ù…ØªØ®ØµØµÙŠÙ†</p>
                
                <div class="quick-stats">
                    <div class="stat-item">
                        <div class="stat-value">200+</div>
                        <div class="stat-label">Ø·Ø¨ÙŠØ¨ Ù…ØªØ®ØµØµ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">24/7</div>
                        <div class="stat-label">Ø­Ø¬Ø² Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">4.9</div>
                        <div class="stat-label">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø±Ø¶Ù‰</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="appointment-content">
            <!-- Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø­Ø¬Ø² -->
            <div class="booking-steps">
                <div class="step active" data-step="1">
                    <div class="step-number">1</div>
                    <div class="step-label">Ø§Ø®ØªØ± Ø§Ù„Ø·Ø¨ÙŠØ¨</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-number">2</div>
                    <div class="step-label">Ø­Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ¹Ø¯</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-number">3</div>
                    <div class="step-label">Ø§ÙƒØªØ¨ Ø§Ù„ØªÙØ§ØµÙŠÙ„</div>
                </div>
                <div class="step" data-step="4">
                    <div class="step-number">4</div>
                    <div class="step-label">Ø§Ø¯ÙØ¹ ÙˆØ£ÙƒØ¯</div>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·Ø¨ÙŠØ¨ -->
            <div class="step-content active" id="step1">
                <div class="section-title">Ø§Ø®ØªØ± Ø·Ø¨ÙŠØ¨Ùƒ</div>
                
                <!-- Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… -->
                <div class="search-section">
                    <div class="search-container">
                        <input type="text" class="search-input" id="doctorSearch" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ø¨ÙŠØ¨ Ø£Ùˆ ØªØ®ØµØµ...">
                        <i class="fas fa-search search-icon"></i>
                    </div>
                    <div class="search-filters">
                        <select class="filter-select" id="specialtyFilter">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ®ØµØµØ§Øª</option>
                            <option value="cardiology">Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨</option>
                            <option value="neurology">Ø§Ù„Ø£Ø¹ØµØ§Ø¨</option>
                            <option value="pediatrics">Ø·Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„</option>
                            <option value="surgery">Ø§Ù„Ø¬Ø±Ø§Ø­Ø©</option>
                            <option value="eyes">Ø§Ù„Ø¹ÙŠÙˆÙ†</option>
                            <option value="teeth">Ø§Ù„Ø£Ø³Ù†Ø§Ù†</option>
                            <option value="skin">Ø§Ù„Ø¬Ù„Ø¯ÙŠØ©</option>
                            <option value="internal">Ø§Ù„Ø¨Ø§Ø·Ù†ÙŠØ©</option>
                        </select>
                        <select class="filter-select" id="locationFilter">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</option>
                            <option value="sanaa">ØµÙ†Ø¹Ø§Ø¡</option>
                            <option value="aden">Ø¹Ø¯Ù†</option>
                            <option value="taiz">ØªØ¹Ø²</option>
                            <option value="hodeidah">Ø§Ù„Ø­Ø¯ÙŠØ¯Ø©</option>
                            <option value="ibb">Ø¥Ø¨</option>
                        </select>
                    </div>
                </div>

                <!-- Ø§Ù„ØªØ®ØµØµØ§Øª -->
                <div class="section-title">Ø§Ù„ØªØ®ØµØµØ§Øª Ø§Ù„Ø·Ø¨ÙŠØ©</div>
                <div class="specialties-section">
                    <div class="specialties-grid" id="specialtiesGrid">
                        <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                    </div>
                </div>

                <!-- Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ -->
                <div class="section-title">Ø§Ù„Ø£Ø·Ø¨Ø§Ø¡ Ø§Ù„Ù…ØªØ§Ø­ÙˆÙ†</div>
                <div class="doctors-section">
                    <div class="doctors-grid" id="doctorsGrid">
                        <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                    </div>
                </div>

                <div class="step-actions">
                    <button class="btn btn-primary next-step" data-next="2" disabled>
                        Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆØ¹Ø¯ -->
            <div class="step-content" id="step2">
                <div class="section-title">Ø­Ø¯Ø¯ ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ù…ÙˆØ¹Ø¯</div>
                
                <div class="appointment-details-card">
                    <div class="selected-doctor-info">
                        <div class="doctor-avatar" id="selectedDoctorAvatar">ğŸ‘¨â€âš•ï¸</div>
                        <div class="doctor-info">
                            <div class="doctor-name" id="selectedDoctorName">---</div>
                            <div class="doctor-specialty" id="selectedDoctorSpecialty">---</div>
                            <div class="doctor-price" id="selectedDoctorPrice">--- Ø±.ÙŠ</div>
                        </div>
                    </div>
                </div>

                <div class="calendar-section">
                    <div class="calendar-header">
                        <button class="nav-btn prev-month"><i class="fas fa-chevron-right"></i></button>
                        <div class="current-month" id="currentMonth">Ù…Ø§Ø±Ø³ 2024</div>
                        <button class="nav-btn next-month"><i class="fas fa-chevron-left"></i></button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                    </div>
                </div>

                <div class="time-slots-section">
                    <div class="section-title">Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­Ø©</div>
                    <div class="time-slots-grid" id="timeSlotsGrid">
                        <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±Ø¨Øª -->
                    </div>
                </div>

                <div class="step-actions">
                    <button class="btn btn-secondary prev-step" data-prev="1">
                        <i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                    </button>
                    <button class="btn btn-primary next-step" data-next="3" disabled>
                        Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 3: ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø² -->
            <div class="step-content" id="step3">
                <div class="section-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¹Ø¯</div>
                
                <div class="appointment-summary-card">
                    <div class="summary-header">Ù…Ù„Ø®Øµ Ø§Ù„Ø­Ø¬Ø²</div>
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„Ø·Ø¨ÙŠØ¨:</span>
                        <span class="summary-value" id="summaryDoctor">---</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„ØªØ§Ø±ÙŠØ®:</span>
                        <span class="summary-value" id="summaryDate">---</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„ÙˆÙ‚Øª:</span>
                        <span class="summary-value" id="summaryTime">---</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„ØªÙƒÙ„ÙØ©:</span>
                        <span class="summary-value" id="summaryCost">--- Ø±.ÙŠ</span>
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-group">
                        <label class="form-label">Ø³Ø¨Ø¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø© *</label>
                        <select class="form-select" id="visitReason" required>
                            <option value="">Ø§Ø®ØªØ± Ø³Ø¨Ø¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</option>
                            <option value="checkup">ÙØ­Øµ Ø¯ÙˆØ±ÙŠ</option>
                            <option value="followup">Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø©</option>
                            <option value="consultation">Ø§Ø³ØªØ´Ø§Ø±Ø© Ø·Ø¨ÙŠØ©</option>
                            <option value="emergency">Ø­Ø§Ù„Ø© Ø·Ø§Ø±Ø¦Ø©</option>
                            <option value="prescription">ØªØ¬Ø¯ÙŠØ¯ Ø±ÙˆØ´ØªØ©</option>
                            <option value="other">Ø³Ø¨Ø¨ Ø¢Ø®Ø±</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ÙˆØµÙ Ø§Ù„Ø­Ø§Ù„Ø© *</label>
                        <textarea class="form-textarea" id="conditionDescription" 
                                  placeholder="ØµÙ Ø­Ø§Ù„ØªÙƒ Ø§Ù„ØµØ­ÙŠØ© ÙˆØ§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù„ØªÙŠ ØªØ¹Ø§Ù†ÙŠ Ù…Ù†Ù‡Ø§..." 
                                  rows="4" required></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Ù‡Ù„ Ù‡Ø°Ù‡ Ø£ÙˆÙ„ Ø²ÙŠØ§Ø±Ø©ØŸ *</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="firstVisit" value="yes" required>
                                <span class="radio-custom"></span>
                                Ù†Ø¹Ù…ØŒ Ø£ÙˆÙ„ Ø²ÙŠØ§Ø±Ø©
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="firstVisit" value="no" required>
                                <span class="radio-custom"></span>
                                Ù„Ø§ØŒ Ø²ÙŠØ§Ø±Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                        <div class="file-upload-container">
                            <input type="file" id="medicalFiles" multiple accept="image/*,.pdf,.doc,.docx" style="display: none;">
                            <button type="button" class="file-upload-btn" onclick="document.getElementById('medicalFiles').click()">
                                <i class="fas fa-cloud-upload-alt"></i>
                                Ø±ÙØ¹ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ©
                            </button>
                            <div class="file-list" id="fileList"></div>
                        </div>
                        <small class="form-hint">ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±ØŒ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±ØŒ Ø£Ùˆ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ Ø§Ù„Ø·Ø¨ÙŠØ© (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 5 Ù…Ù„ÙØ§Øª)</small>
                    </div>

                    <div class="insurance-section">
                        <label class="checkbox-label">
                            <input type="checkbox" id="hasInsurance">
                            <span class="checkbox-custom"></span>
                            Ù„Ø¯ÙŠ ØªØ£Ù…ÙŠÙ† Ø·Ø¨ÙŠ
                        </label>
                        <div class="insurance-details" id="insuranceDetails" style="display: none;">
                            <div class="form-group">
                                <label class="form-label">Ø´Ø±ÙƒØ© Ø§Ù„ØªØ£Ù…ÙŠÙ†</label>
                                <input type="text" class="form-input" id="insuranceCompany" placeholder="Ø§Ø³Ù… Ø´Ø±ÙƒØ© Ø§Ù„ØªØ£Ù…ÙŠÙ†">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ø¨ÙˆÙ„ÙŠØµØ©</label>
                                <input type="text" class="form-input" id="policyNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø¨ÙˆÙ„ÙŠØµØ©">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="step-actions">
                    <button class="btn btn-secondary prev-step" data-prev="2">
                        <i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                    </button>
                    <button class="btn btn-primary next-step" data-next="4">
                        Ø§Ù„ØªØ§Ù„ÙŠ <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯ -->
            <div class="step-content" id="step4">
                <div class="section-title">Ø§Ù„Ø¯ÙØ¹ ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²</div>
                
                <div class="payment-summary-card">
                    <div class="summary-header">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯ÙØ¹</div>
                    <div class="appointment-number" id="appointmentNumber">APT-2024-001</div>
                    
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„Ø·Ø¨ÙŠØ¨:</span>
                        <span class="summary-value" id="paymentDoctor">---</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø§Ù„Ù…ÙˆØ¹Ø¯:</span>
                        <span class="summary-value" id="paymentDateTime">---</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Ø³Ø¨Ø¨ Ø§Ù„Ø²ÙŠØ§Ø±Ø©:</span>
                        <span class="summary-value" id="paymentReason">---</span>
                    </div>
                    <div class="summary-item total">
                        <span class="summary-label">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚:</span>
                        <span class="summary-value" id="paymentAmount">--- Ø±.ÙŠ</span>
                    </div>
                </div>

                <div class="payment-methods-section">
                    <div class="section-title">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</div>
                    
                    <div class="payment-methods">
                        <div class="payment-method active" data-method="wallet">
                            <div class="method-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="method-name">Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©</div>
                        </div>
                        <div class="payment-method" data-method="card">
                            <div class="method-icon">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <div class="method-name">Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ©</div>
                        </div>
                        <div class="payment-method" data-method="cash">
                            <div class="method-icon">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <div class="method-name">Ø§Ù„Ø¯ÙØ¹ ÙÙŠ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø©</div>
                        </div>
                    </div>

                    <div class="payment-details" id="walletPayment">
                        <div class="form-group">
                            <label class="form-label">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©</label>
                            <select class="form-select" id="selectedWallet" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©</option>
                            </select>
                        </div>
                        <div class="balance-info">
                            Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: <span id="walletBalance">0 Ø±.ÙŠ</span>
                        </div>
                    </div>

                    <div class="payment-details" id="cardPayment" style="display: none;">
                        <div class="form-group">
                            <label class="form-label">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</label>
                            <select class="form-select" id="selectedCard" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</option>
                            </select>
                        </div>
                    </div>

                    <div class="payment-details" id="cashPayment" style="display: none;">
                        <div class="cash-notice">
                            <i class="fas fa-info-circle"></i>
                            Ø³ÙŠØªÙ… Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ¹Ø¯ ÙˆØ³ÙˆÙ ØªÙ‚ÙˆÙ… Ø¨Ø§Ù„Ø¯ÙØ¹ Ù†Ù‚Ø¯Ø§Ù‹ ÙÙŠ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø© Ø¹Ù†Ø¯ ÙˆØµÙˆÙ„Ùƒ.
                        </div>
                    </div>
                </div>

                <div class="security-section">
                    <div class="security-notice">
                        <i class="fas fa-shield-alt"></i>
                        <span>Ø¬Ù…ÙŠØ¹ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÙƒ Ù…Ø­Ù…ÙŠØ© ÙˆÙ…Ø´ÙØ±Ø©</span>
                    </div>
                </div>

                <div class="step-actions">
                    <button class="btn btn-secondary prev-step" data-prev="3">
                        <i class="fas fa-arrow-right"></i> Ø§Ù„Ø³Ø§Ø¨Ù‚
                    </button>
                    <button class="btn btn-primary confirm-booking" id="confirmBooking">
                        <i class="fas fa-check-circle"></i>
                        ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² ÙˆØ§Ù„Ø¯ÙØ¹
                    </button>
                </div>
            </div>
        </div>

        <!-- Ù†ÙˆØ§ÙØ° Ù…Ù†Ø¨Ø«Ù‚Ø© -->
        
        <!-- Ù†Ø§ÙØ°Ø© ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø² -->
        <div id="confirmationModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­</div>
                    <button class="close-modal" onclick="closeModal('confirmationModal')">Ã—</button>
                </div>
                
                <div class="confirmation-content">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯Ùƒ</h3>
                    <p>Ø³Ù†Ø±Ø³Ù„ Ù„Ùƒ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø¨Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø¹Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØ±Ù‚Ù… Ù‡Ø§ØªÙÙƒ</p>
                    
                    <div class="appointment-details">
                        <div class="detail-item">
                            <span class="detail-label">Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²:</span>
                            <span class="detail-value" id="finalAppointmentNumber">APT-2024-001</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Ø§Ù„Ø·Ø¨ÙŠØ¨:</span>
                            <span class="detail-value" id="finalDoctorName">---</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª:</span>
                            <span class="detail-value" id="finalAppointmentTime">---</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</span>
                            <span class="detail-value" id="finalClinicAddress">---</span>
                        </div>
                    </div>

                    <div class="reminder-notice">
                        <i class="fas fa-bell"></i>
                        <span>Ø³ÙŠØªÙ… ØªØ°ÙƒÙŠØ±Ùƒ Ù‚Ø¨Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù€ 24 Ø³Ø§Ø¹Ø© Ùˆ 2 Ø³Ø§Ø¹Ø©</span>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="closeModal('confirmationModal'); window.location.href='index.html'">
                        <i class="fas fa-home"></i>
                        Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </button>
                    <button class="btn btn-secondary" onclick="closeModal('confirmationModal')">
                        <i class="fas fa-calendar-alt"></i>
                        Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯
                    </button>
                </div>
            </div>
        </div>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ -->
        <div class="bottom-nav-premium">
            <a href="index.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-home"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            </a>
            <a href="consultation.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-stethoscope"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª</div>
            </a>
            <a href="doctor-appointment.html" class="nav-item-premium active">
                <div class="nav-icon-premium">
                    <i class="fas fa-calendar-plus"></i>
                </div>
                <div class="nav-label">Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯</div>
            </a>
            <a href="financial.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-wallet"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ù…Ø§Ù„</div>
            </a>
            <a href="profile.html" class="nav-item-premium">
                <div class="nav-icon-premium">
                    <i class="fas fa-user"></i>
                </div>
                <div class="nav-label">Ø­Ø³Ø§Ø¨ÙŠ</div>
            </a>
        </div>
    </div>

    <script>
   // Ù†Ø¸Ø§Ù… Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„
class DoctorAppointmentSystem {
    constructor() {
        this.specialties = [];
        this.doctors = [];
        this.userAppointments = JSON.parse(localStorage.getItem('userAppointments')) || [];
        this.currentAppointment = {
            doctor: null,
            date: null,
            time: null,
            reason: '',
            description: '',
            isFirstVisit: null,
            attachments: [],
            insurance: null,
            paymentMethod: 'wallet'
        };
        this.currentStep = 1;
        this.currentMonth = new Date();
        this.init();
    }

    init() {
        this.loadSpecialties();
        this.loadDoctors();
        this.setupEventListeners();
        this.updateTime();
        this.loadUserData();
        this.initializeCalendar();
        setInterval(() => this.updateTime(), 60000);
    }

    setupEventListeners() {
        // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
        const doctorSearch = document.getElementById('doctorSearch');
        if (doctorSearch) {
            doctorSearch.addEventListener('input', (e) => {
                this.handleSearch(e.target.value);
            });
        }

        // Ø§Ù„ÙÙ„Ø§ØªØ±
        const specialtyFilter = document.getElementById('specialtyFilter');
        if (specialtyFilter) {
            specialtyFilter.addEventListener('change', () => {
                this.applyFilters();
            });
        }

        const locationFilter = document.getElementById('locationFilter');
        if (locationFilter) {
            locationFilter.addEventListener('change', () => {
                this.applyFilters();
            });
        }

        // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ§Øª
        document.querySelectorAll('.next-step').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const nextStep = parseInt(e.target.closest('.next-step').dataset.next);
                this.goToStep(nextStep);
            });
        });

        document.querySelectorAll('.prev-step').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const prevStep = parseInt(e.target.closest('.prev-step').dataset.prev);
                this.goToStep(prevStep);
            });
        });

        // Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ø·Ø¨ÙŠ
        const hasInsurance = document.getElementById('hasInsurance');
        if (hasInsurance) {
            hasInsurance.addEventListener('change', (e) => {
                this.toggleInsuranceDetails(e.target.checked);
            });
        }

        // Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹
        document.querySelectorAll('.payment-method').forEach(method => {
            method.addEventListener('click', (e) => {
                this.selectPaymentMethod(e.currentTarget.dataset.method);
            });
        });

        // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
        const confirmBooking = document.getElementById('confirmBooking');
        if (confirmBooking) {
            confirmBooking.addEventListener('click', () => {
                this.confirmBooking();
            });
        }

        // Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª
        const medicalFiles = document.getElementById('medicalFiles');
        if (medicalFiles) {
            medicalFiles.addEventListener('change', (e) => {
                this.handleFileUpload(e.target.files);
            });
        }

        // Ø§Ù„ØªÙ†Ù‚Ù„ ÙÙŠ Ø§Ù„ØªÙ‚ÙˆÙŠÙ…
        const prevMonth = document.querySelector('.prev-month');
        const nextMonth = document.querySelector('.next-month');
        
        if (prevMonth) {
            prevMonth.addEventListener('click', () => {
                this.navigateMonth(-1);
            });
        }
        
        if (nextMonth) {
            nextMonth.addEventListener('click', () => {
                this.navigateMonth(1);
            });
        }
    }

    loadUserData() {
        this.userAccount = JSON.parse(localStorage.getItem('financialAccount'));
        this.userWallets = JSON.parse(localStorage.getItem('linkedWallets')) || [];
        this.userCards = JSON.parse(localStorage.getItem('linkedCards')) || [];
    }

    loadSpecialties() {
        this.specialties = [
            {
                id: 1,
                name: 'Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨',
                icon: 'fa-heartbeat',
                doctorCount: 25,
                color: '#ef4444',
                description: 'ØªØ´Ø®ÙŠØµ ÙˆØ¹Ù„Ø§Ø¬ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ ÙˆØ§Ù„Ø´Ø±Ø§ÙŠÙŠÙ†'
            },
            {
                id: 2,
                name: 'Ø§Ù„Ø£Ø¹ØµØ§Ø¨',
                icon: 'fa-brain',
                doctorCount: 18,
                color: '#8b5cf6',
                description: 'Ø¹Ù„Ø§Ø¬ Ø§Ø¶Ø·Ø±Ø§Ø¨Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¹ØµØ¨ÙŠ'
            },
            {
                id: 3,
                name: 'Ø·Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„',
                icon: 'fa-baby',
                doctorCount: 32,
                color: '#3b82f6',
                description: 'Ø±Ø¹Ø§ÙŠØ© ØµØ­ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ø£Ø·ÙØ§Ù„'
            },
            {
                id: 4,
                name: 'Ø§Ù„Ø¬Ø±Ø§Ø­Ø©',
                icon: 'fa-syringe',
                doctorCount: 15,
                color: '#f59e0b',
                description: 'Ø¹Ù…Ù„ÙŠØ§Øª Ø¬Ø±Ø§Ø­ÙŠØ© ÙˆØªØ´Ø®ÙŠØµÙŠØ©'
            },
            {
                id: 5,
                name: 'Ø§Ù„Ø¹ÙŠÙˆÙ†',
                icon: 'fa-eye',
                doctorCount: 12,
                color: '#06b6d4',
                description: 'Ø¹Ù„Ø§Ø¬ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø¹ÙŠÙˆÙ† ÙˆØ§Ù„Ø±Ø¤ÙŠØ©'
            },
            {
                id: 6,
                name: 'Ø§Ù„Ø£Ø³Ù†Ø§Ù†',
                icon: 'fa-tooth',
                doctorCount: 20,
                color: '#84cc16',
                description: 'Ø¹Ù†Ø§ÙŠØ© Ø´Ø§Ù…Ù„Ø© Ø¨ØµØ­Ø© Ø§Ù„ÙÙ… ÙˆØ§Ù„Ø£Ø³Ù†Ø§Ù†'
            },
            {
                id: 7,
                name: 'Ø§Ù„Ø¬Ù„Ø¯ÙŠØ©',
                icon: 'fa-allergies',
                doctorCount: 14,
                color: '#f97316',
                description: 'Ø¹Ù„Ø§Ø¬ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø¬Ù„Ø¯ÙŠØ© ÙˆØ§Ù„ØªØ¬Ù…ÙŠÙ„'
            },
            {
                id: 8,
                name: 'Ø§Ù„Ø¨Ø§Ø·Ù†ÙŠØ©',
                icon: 'fa-stethoscope',
                doctorCount: 28,
                color: '#ec4899',
                description: 'ØªØ´Ø®ÙŠØµ ÙˆØ¹Ù„Ø§Ø¬ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©'
            }
        ];
        this.renderSpecialties();
    }

    loadDoctors() {
        this.doctors = [
            {
                id: 1,
                name: 'Ø¯. Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',
                specialty: 'Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨',
                specialtyId: 1,
                rating: 4.8,
                ratingCount: 124,
                experience: '15 Ø³Ù†Ø©',
                price: 150,
                location: 'sanaa',
                availability: ['now', 'today'],
                features: ['ÙƒØ´Ù Ø¯ÙˆØ±ÙŠ', 'Ù…ØªØ§Ø¨Ø¹Ø©', 'Ø§Ø³ØªØ´Ø§Ø±Ø©'],
                image: 'ğŸ‘¨â€âš•ï¸',
                bio: 'Ø§Ø³ØªØ´Ø§Ø±ÙŠ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ ÙˆØ§Ù„Ø´Ø±Ø§ÙŠÙŠÙ†ØŒ Ø­Ø§ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ±Ø¯ Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠ',
                education: 'Ø¯ÙƒØªÙˆØ±Ø§Ù‡ ÙÙŠ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù‚Ù„Ø¨ - Ø¬Ø§Ù…Ø¹Ø© Ù‡Ø§Ø±ÙØ§Ø±Ø¯',
                languages: ['Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©'],
                clinic: {
                    name: 'Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„Ù‚Ù„Ø¨ Ø§Ù„Ù…ØªØ®ØµØµØ©',
                    address: 'Ø´Ø§Ø±Ø¹ Ø§Ù„Ø²Ø¨ÙŠØ±ÙŠØŒ ØµÙ†Ø¹Ø§Ø¡',
                    phone: '017234567'
                },
                availableSlots: this.generateTimeSlots(true)
            },
            {
                id: 2,
                name: 'Ø¯. Ø³Ø§Ø±Ø© Ø®Ø§Ù„Ø¯',
                specialty: 'Ø·Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„',
                specialtyId: 3,
                rating: 4.9,
                ratingCount: 98,
                experience: '12 Ø³Ù†Ø©',
                price: 120,
                location: 'sanaa',
                availability: ['today', 'week'],
                features: ['ÙƒØ´Ù Ø£Ø·ÙØ§Ù„', 'ØªØ·Ø¹ÙŠÙ…Ø§Øª', 'Ø§Ø³ØªØ´Ø§Ø±Ø©'],
                image: 'ğŸ‘©â€âš•ï¸',
                bio: 'Ø§Ø³ØªØ´Ø§Ø±ÙŠØ© Ø·Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„ ÙˆØ­Ø¯ÙŠØ«ÙŠ Ø§Ù„ÙˆÙ„Ø§Ø¯Ø©',
                education: 'Ù…Ø§Ø¬Ø³ØªÙŠØ± Ø·Ø¨ Ø§Ù„Ø£Ø·ÙØ§Ù„ - Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù…Ù„Ùƒ Ø³Ø¹ÙˆØ¯',
                languages: ['Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', 'Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©'],
                clinic: {
                    name: 'Ù…Ø±ÙƒØ² Ø±Ø¹Ø§ÙŠØ© Ø§Ù„Ø·ÙÙ„',
                    address: 'Ø­ÙŠ Ø§Ù„ØªØ¹Ø§ÙˆÙ†ØŒ ØµÙ†Ø¹Ø§Ø¡',
                    phone: '017234568'
                },
                availableSlots: this.generateTimeSlots(false)
            },
            {
                id: 3,
                name: 'Ø¯. Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ',
                specialty: 'Ø§Ù„Ø£Ø¹ØµØ§Ø¨',
                specialtyId: 2,
                rating: 4.7,
                ratingCount: 87,
                experience: '18 Ø³Ù†Ø©',
                price: 180,
                location: 'aden',
                availability: ['now'],
                features: ['ÙƒØ´Ù Ø£Ø¹ØµØ§Ø¨', 'Ù…ØªØ§Ø¨Ø¹Ø©', 'Ø§Ø³ØªØ´Ø§Ø±Ø©'],
                image: 'ğŸ‘¨â€âš•ï¸',
                bio: 'Ø£Ø³ØªØ§Ø° Ù…Ø³Ø§Ø¹Ø¯ ÙÙŠ Ø·Ø¨ Ø§Ù„Ø£Ø¹ØµØ§Ø¨ØŒ Ù…ØªØ®ØµØµ ÙÙŠ Ø§Ù„ØµØ¯Ø§Ø¹ ÙˆØ§Ù„Ø£Ù„Ù…',
                education: 'Ø¨ÙˆØ±Ø¯ Ø§Ù„Ø£Ø¹ØµØ§Ø¨ - Ø§Ù„Ù…Ø¹Ù‡Ø¯ Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø£Ø¹ØµØ§Ø¨',
                languages: ['Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©'],
                clinic: {
                    name: 'Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„Ø£Ø¹ØµØ§Ø¨ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©',
                    address: 'ÙƒØ±ÙŠØªØ±ØŒ Ø¹Ø¯Ù†',
                    phone: '027234569'
                },
                availableSlots: this.generateTimeSlots(true)
            },
            {
                id: 4,
                name: 'Ø¯. ÙØ§Ø·Ù…Ø© Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡',
                specialty: 'Ø§Ù„Ø£Ø³Ù†Ø§Ù†',
                specialtyId: 6,
                rating: 4.6,
                ratingCount: 76,
                experience: '10 Ø³Ù†Ø©',
                price: 100,
                location: 'taiz',
                availability: ['today', 'week'],
                features: ['ÙƒØ´Ù Ø£Ø³Ù†Ø§Ù†', 'ØªÙ†Ø¸ÙŠÙ', 'Ø­Ø´Ùˆ'],
                image: 'ğŸ‘©â€âš•ï¸',
                bio: 'Ø§Ø®ØªØµØ§ØµÙŠØ© ØªØ¬Ù…ÙŠÙ„ ÙˆØ²Ø±Ø§Ø¹Ø© Ø§Ù„Ø£Ø³Ù†Ø§Ù†',
                education: 'Ø¯Ø¨Ù„ÙˆÙ… Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø£Ø³Ù†Ø§Ù† - Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©',
                languages: ['Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'],
                clinic: {
                    name: 'Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ø¨ØªØ³Ø§Ù…Ø© Ø§Ù„Ù…Ø´Ø±Ù‚Ø©',
                    address: 'Ø´Ø§Ø±Ø¹ 26 Ø³Ø¨ØªÙ…Ø¨Ø±ØŒ ØªØ¹Ø²',
                    phone: '047234570'
                },
                availableSlots: this.generateTimeSlots(false)
            },
            {
                id: 5,
                name: 'Ø¯. Ø®Ø§Ù„Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…',
                specialty: 'Ø§Ù„Ø¬Ù„Ø¯ÙŠØ©',
                specialtyId: 7,
                rating: 4.8,
                ratingCount: 112,
                experience: '14 Ø³Ù†Ø©',
                price: 130,
                location: 'hodeidah',
                availability: ['now', 'today'],
                features: ['ÙƒØ´Ù Ø¬Ù„Ø¯ÙŠ', 'Ø¹Ù„Ø§Ø¬ ØªØ¬Ù…ÙŠÙ„ÙŠ', 'Ø§Ø³ØªØ´Ø§Ø±Ø©'],
                image: 'ğŸ‘¨â€âš•ï¸',
                bio: 'Ø§Ø³ØªØ´Ø§Ø±ÙŠ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø¬Ù„Ø¯ÙŠØ© ÙˆØ§Ù„ØªÙ†Ø§Ø³Ù„ÙŠØ©',
                education: 'Ø²Ù…Ø§Ù„Ø© Ø§Ù„Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø¬Ù„Ø¯ÙŠØ© - Ù„Ù†Ø¯Ù†',
                languages: ['Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©'],
                clinic: {
                    name: 'Ù…Ø±ÙƒØ² Ø§Ù„Ø¬Ù„Ø¯ÙŠØ© ÙˆØ§Ù„ØªØ¬Ù…ÙŠÙ„',
                    address: 'Ø§Ù„Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯ØŒ Ø§Ù„Ø­Ø¯ÙŠØ¯Ø©',
                    phone: '037234571'
                },
                availableSlots: this.generateTimeSlots(true)
            },
            {
                id: 6,
                name: 'Ø¯. Ù…Ù†Ù‰ Ø§Ù„Ø³ÙŠØ¯',
                specialty: 'Ø§Ù„Ø¨Ø§Ø·Ù†ÙŠØ©',
                specialtyId: 8,
                rating: 4.9,
                ratingCount: 145,
                experience: '16 Ø³Ù†Ø©',
                price: 140,
                location: 'ibb',
                availability: ['today', 'week'],
                features: ['ÙƒØ´Ù Ø¨Ø§Ø·Ù†ÙŠ', 'Ù…ØªØ§Ø¨Ø¹Ø©', 'Ø§Ø³ØªØ´Ø§Ø±Ø©'],
                image: 'ğŸ‘©â€âš•ï¸',
                bio: 'Ø§Ø³ØªØ´Ø§Ø±ÙŠØ© Ø§Ù„Ø¨Ø§Ø·Ù†ÙŠØ© ÙˆØ£Ù…Ø±Ø§Ø¶ Ø§Ù„Ø³ÙƒØ±ÙŠ ÙˆØ§Ù„ØºØ¯Ø¯',
                education: 'Ø¯ÙƒØªÙˆØ±Ø§Ù‡ Ø§Ù„Ø¨Ø§Ø·Ù†ÙŠØ© - Ø¬Ø§Ù…Ø¹Ø© Ø¹ÙŠÙ† Ø´Ù…Ø³',
                languages: ['Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', 'Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©'],
                clinic: {
                    name: 'Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„Ø¨Ø§Ø·Ù†ÙŠØ© Ø§Ù„Ø¹Ø§Ù…Ø©',
                    address: 'Ø­ÙŠ Ø§Ù„Ù…ØµÙŠÙ†Ø¹Ø©ØŒ Ø¥Ø¨',
                    phone: '057234572'
                },
                availableSlots: this.generateTimeSlots(false)
            }
        ];
        this.renderDoctors();
    }

    generateTimeSlots(isAvailableNow) {
        const slots = [];
        const now = new Date();
        
        if (isAvailableNow) {
            // Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…
            for (let i = 1; i <= 6; i++) {
                const slotTime = new Date(now);
                slotTime.setHours(9 + i * 2); // Ù…Ù† 11 ØµØ¨Ø§Ø­Ø§Ù‹
                slotTime.setMinutes(0);
                
                if (slotTime > now) {
                    slots.push({
                        time: slotTime.toTimeString().slice(0, 5),
                        display: slotTime.toLocaleTimeString('ar-EG', { 
                            hour: '2-digit', 
                            minute: '2-digit',
                            hour12: true 
                        }),
                        available: true
                    });
                }
            }
        } else {
            // Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
            const days = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©'];
            for (let i = 1; i <= 3; i++) {
                const slotDate = new Date(now);
                slotDate.setDate(now.getDate() + i);
                
                for (let j = 0; j < 4; j++) {
                    const slotTime = new Date(slotDate);
                    slotTime.setHours(10 + j * 2);
                    slotTime.setMinutes(0);
                    
                    slots.push({
                        time: slotTime.toISOString(),
                        display: `${days[slotDate.getDay()]} - ${slotTime.toLocaleTimeString('ar-EG', { 
                            hour: '2-digit', 
                            minute: '2-digit',
                            hour12: true 
                        })}`,
                        available: true
                    });
                }
            }
        }

        return slots;
    }

    renderSpecialties() {
        const container = document.getElementById('specialtiesGrid');
        if (!container) return;

        container.innerHTML = '';

        this.specialties.forEach(specialty => {
            const specialtyElement = document.createElement('div');
            specialtyElement.className = 'specialty-card';
            specialtyElement.onclick = () => this.filterBySpecialty(specialty.id);
            specialtyElement.title = specialty.description;
            
            specialtyElement.innerHTML = `
                <div class="specialty-icon" style="background: ${specialty.color}">
                    <i class="fas ${specialty.icon}"></i>
                </div>
                <div class="specialty-name">${specialty.name}</div>
                <div class="specialty-count">${specialty.doctorCount} Ø·Ø¨ÙŠØ¨</div>
            `;
            
            container.appendChild(specialtyElement);
        });
    }

    renderDoctors(filteredDoctors = null) {
        const container = document.getElementById('doctorsGrid');
        if (!container) return;

        const doctorsToShow = filteredDoctors || this.doctors;

        if (doctorsToShow.length === 0) {
            container.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                    <i class="fas fa-user-md" style="font-size: 48px; margin-bottom: 16px;"></i>
                    <div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>
                    <p style="font-size: 14px; margin-top: 8px;">Ø¬Ø±Ø¨ ØªØºÙŠÙŠØ± Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                </div>
            `;
            return;
        }

        container.innerHTML = '';

        doctorsToShow.forEach(doctor => {
            const doctorElement = document.createElement('div');
            doctorElement.className = `doctor-card ${this.currentAppointment.doctor?.id === doctor.id ? 'selected' : ''}`;
            doctorElement.onclick = () => this.selectDoctor(doctor);
            
            const stars = this.generateStars(doctor.rating);
            const locationText = this.getLocationText(doctor.location);
            
            doctorElement.innerHTML = `
                <div class="doctor-avatar">
                    ${doctor.image}
                </div>
                <div class="doctor-info">
                    <div class="doctor-name">${doctor.name}</div>
                    <div class="doctor-specialty">${doctor.specialty} â€¢ ${doctor.experience}</div>
                    <div class="doctor-rating">
                        <div class="stars">${stars}</div>
                        <div class="rating-value">${doctor.rating}</div>
                        <div class="rating-count">(${doctor.ratingCount})</div>
                    </div>
                    <div class="doctor-features">
                        ${doctor.features.map(feature => `<span class="feature-tag">${feature}</span>`).join('')}
                    </div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">
                        <i class="fas fa-map-marker-alt"></i>
                        ${locationText} â€¢ ${doctor.clinic.name}
                    </div>
                </div>
                <div class="doctor-actions">
                    <button class="select-btn" onclick="event.stopPropagation(); appointmentSystem.selectDoctor(${doctor.id})">
                        <i class="fas fa-calendar-check"></i>
                        Ø§Ø®ØªØ±
                    </button>
                    <div class="price">${doctor.price} Ø±.ÙŠ</div>
                </div>
            `;
            
            container.appendChild(doctorElement);
        });
    }

    getLocationText(location) {
        const locations = {
            'sanaa': 'ØµÙ†Ø¹Ø§Ø¡',
            'aden': 'Ø¹Ø¯Ù†',
            'taiz': 'ØªØ¹Ø²',
            'hodeidah': 'Ø§Ù„Ø­Ø¯ÙŠØ¯Ø©',
            'ibb': 'Ø¥Ø¨'
        };
        return locations[location] || location;
    }

    generateStars(rating) {
        const fullStars = Math.floor(rating);
        const halfStar = rating % 1 >= 0.5;
        const emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
        
        let stars = '';
        
        for (let i = 0; i < fullStars; i++) {
            stars += '<i class="fas fa-star"></i>';
        }
        
        if (halfStar) {
            stars += '<i class="fas fa-star-half-alt"></i>';
        }
        
        for (let i = 0; i < emptyStars; i++) {
            stars += '<i class="far fa-star"></i>';
        }
        
        return stars;
    }

    selectDoctor(doctor) {
        if (typeof doctor === 'number') {
            doctor = this.doctors.find(d => d.id === doctor);
        }

        if (!doctor) {
            this.showNotification('Ø§Ù„Ø·Ø¨ÙŠØ¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
            return;
        }

        this.currentAppointment.doctor = doctor;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.querySelectorAll('.doctor-card').forEach(card => {
            card.classList.remove('selected');
        });
        
        event.target.closest('.doctor-card').classList.add('selected');
        
        // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ
        document.querySelector('.next-step[data-next="2"]').disabled = false;
        
        this.showNotification(`ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${doctor.name}`, 'success');
    }

    handleSearch(query) {
        if (query.length >= 2) {
            const filteredDoctors = this.doctors.filter(doctor => 
                doctor.name.includes(query) || 
                doctor.specialty.includes(query) ||
                doctor.bio.includes(query) ||
                doctor.clinic.name.includes(query)
            );
            this.renderDoctors(filteredDoctors);
        } else if (query.length === 0) {
            this.renderDoctors();
        }
    }

    applyFilters() {
        const specialty = document.getElementById('specialtyFilter').value;
        const location = document.getElementById('locationFilter').value;
        
        let filteredDoctors = this.doctors;
        
        if (specialty) {
            filteredDoctors = filteredDoctors.filter(doctor => 
                doctor.specialty === specialty
            );
        }
        
        if (location) {
            filteredDoctors = filteredDoctors.filter(doctor => 
                doctor.location === location
            );
        }
        
        this.renderDoctors(filteredDoctors);
    }

    filterBySpecialty(specialtyId) {
        const filteredDoctors = this.doctors.filter(doctor => doctor.specialtyId === specialtyId);
        this.renderDoctors(filteredDoctors);
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ù†Ø´Ø·
        document.querySelectorAll('.specialty-card').forEach(card => {
            card.classList.remove('active');
        });
        event.target.closest('.specialty-card').classList.add('active');
        
        this.showNotification(`ØªÙ… Ø¹Ø±Ø¶ Ø£Ø·Ø¨Ø§Ø¡ Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ù…Ø­Ø¯Ø¯`, 'info');
    }

    goToStep(step) {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„
        if (step > this.currentStep) {
            if (!this.validateStep(this.currentStep)) {
                this.showNotification('ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
                return;
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø®Ø·ÙˆØ§Øª
        document.querySelectorAll('.step').forEach(stepElement => {
            stepElement.classList.remove('active');
            if (parseInt(stepElement.dataset.step) <= step) {
                stepElement.classList.add('completed');
            }
        });
        
        document.querySelector(`.step[data-step="${step}"]`).classList.add('active');

        // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
        document.querySelectorAll('.step-content').forEach(content => {
            content.classList.remove('active');
        });

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
        document.getElementById(`step${step}`).classList.add('active');

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
        if (step === 2) {
            this.updateSelectedDoctorInfo();
            this.generateTimeSlotsForDoctor();
        } else if (step === 3) {
            this.updateAppointmentSummary();
        } else if (step === 4) {
            this.updatePaymentSummary();
            this.loadPaymentMethods();
        }

        this.currentStep = step;
        
        // Scroll to top
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    validateStep(step) {
        switch (step) {
            case 1:
                return !!this.currentAppointment.doctor;
            case 2:
                return !!this.currentAppointment.date && !!this.currentAppointment.time;
            case 3:
                const reason = document.getElementById('visitReason').value;
                const description = document.getElementById('conditionDescription').value;
                const firstVisit = document.querySelector('input[name="firstVisit"]:checked');
                return !!reason && !!description && !!firstVisit;
            default:
                return true;
        }
    }

    updateSelectedDoctorInfo() {
        if (!this.currentAppointment.doctor) return;

        const doctor = this.currentAppointment.doctor;
        
        document.getElementById('selectedDoctorAvatar').textContent = doctor.image;
        document.getElementById('selectedDoctorName').textContent = doctor.name;
        document.getElementById('selectedDoctorSpecialty').textContent = doctor.specialty;
        document.getElementById('selectedDoctorPrice').textContent = doctor.price + ' Ø±.ÙŠ';
    }

    initializeCalendar() {
        this.renderCalendar();
    }

    renderCalendar() {
        const calendarGrid = document.getElementById('calendarGrid');
        if (!calendarGrid) return;

        const monthNames = [
            'ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ',
            'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'
        ];

        const year = this.currentMonth.getFullYear();
        const month = this.currentMonth.getMonth();
        
        document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;

        // Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£ÙŠØ§Ù…
        const dayHeaders = ['Ø£Ø­', 'Ø¥Ø«', 'Ø«', 'Ø£Ø±', 'Ø®', 'Ø¬', 'Ø³'];
        let calendarHTML = '';

        // Ø¥Ø¶Ø§ÙØ© Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£ÙŠØ§Ù…
        dayHeaders.forEach(day => {
            calendarHTML += `<div class="calendar-day-header">${day}</div>`;
        });

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙˆÙ„ ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø´Ù‡Ø±
        const firstDay = new Date(year, month, 1);
        const startingDay = firstDay.getDay(); // 0 = Ø§Ù„Ø£Ø­Ø¯, 1 = Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†, etc.

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… ÙÙŠ Ø§Ù„Ø´Ù‡Ø±
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        // Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„ÙØ§Ø±ØºØ© Ù‚Ø¨Ù„ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø±
        for (let i = 0; i < startingDay; i++) {
            calendarHTML += `<div class="calendar-day disabled"></div>`;
        }

        // Ø£ÙŠØ§Ù… Ø§Ù„Ø´Ù‡Ø±
        const today = new Date();
        today.setHours(0, 0, 0, 0);

        for (let day = 1; day <= daysInMonth; day++) {
            const currentDate = new Date(year, month, day);
            const isToday = currentDate.getTime() === today.getTime();
            const isSelected = this.currentAppointment.date && 
                              currentDate.toDateString() === new Date(this.currentAppointment.date).toDateString();
            const isPast = currentDate < today;
            const isAvailable = !isPast && currentDate.getDay() !== 5; // Ù„Ø§ ØªØ¸Ù‡Ø± Ø§Ù„Ø¬Ù…Ø¹Ø©

            let dayClass = 'calendar-day';
            if (isToday) dayClass += ' today';
            if (isSelected) dayClass += ' selected';
            if (!isAvailable) dayClass += ' disabled';

            calendarHTML += `
                <div class="${dayClass}" data-date="${currentDate.toISOString()}" 
                     onclick="${isAvailable ? 'appointmentSystem.selectDate(this.dataset.date)' : ''}">
                    ${day}
                </div>
            `;
        }

        calendarGrid.innerHTML = calendarHTML;
    }

    navigateMonth(direction) {
        this.currentMonth.setMonth(this.currentMonth.getMonth() + direction);
        this.renderCalendar();
    }

    selectDate(dateString) {
        this.currentAppointment.date = dateString;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.querySelectorAll('.calendar-day').forEach(day => {
            day.classList.remove('selected');
        });
        
        event.target.classList.add('selected');
        
        // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­Ø©
        this.generateTimeSlotsForDoctor();
        
        this.showNotification('ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®', 'success');
    }

    generateTimeSlotsForDoctor() {
        if (!this.currentAppointment.doctor || !this.currentAppointment.date) return;

        const timeSlotsGrid = document.getElementById('timeSlotsGrid');
        if (!timeSlotsGrid) return;

        const doctor = this.currentAppointment.doctor;
        let timeSlotsHTML = '';

        // Ù…Ø­Ø§ÙƒØ§Ø© Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø·Ø¨ÙŠØ¨
        const availableSlots = [
            '09:00', '10:00', '11:00', '12:00', '14:00', '15:00', '16:00', '17:00'
        ];

        availableSlots.forEach(slot => {
            const isSelected = this.currentAppointment.time === slot;
            const slotClass = `time-slot ${isSelected ? 'selected' : ''}`;
            
            const displayTime = new Date(`2000-01-01T${slot}`).toLocaleTimeString('ar-EG', {
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            });

            timeSlotsHTML += `
                <div class="${slotClass}" data-time="${slot}" 
                     onclick="appointmentSystem.selectTime('${slot}')">
                    ${displayTime}
                </div>
            `;
        });

        timeSlotsGrid.innerHTML = timeSlotsHTML;
        
        // ØªÙØ¹ÙŠÙ„ Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ
        document.querySelector('.next-step[data-next="3"]').disabled = false;
    }

    selectTime(time) {
        this.currentAppointment.time = time;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.querySelectorAll('.time-slot').forEach(slot => {
            slot.classList.remove('selected');
        });
        
        event.target.classList.add('selected');
        
        this.showNotification('ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆÙ‚Øª', 'success');
    }

    updateAppointmentSummary() {
        if (!this.currentAppointment.doctor || !this.currentAppointment.date || !this.currentAppointment.time) return;

        const doctor = this.currentAppointment.doctor;
        const date = new Date(this.currentAppointment.date);
        const time = this.currentAppointment.time;

        const formattedDate = date.toLocaleDateString('ar-EG', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        const formattedTime = new Date(`2000-01-01T${time}`).toLocaleTimeString('ar-EG', {
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
        });

        document.getElementById('summaryDoctor').textContent = doctor.name;
        document.getElementById('summaryDate').textContent = formattedDate;
        document.getElementById('summaryTime').textContent = formattedTime;
        document.getElementById('summaryCost').textContent = doctor.price + ' Ø±.ÙŠ';
    }

    updatePaymentSummary() {
        if (!this.currentAppointment.doctor || !this.currentAppointment.date || !this.currentAppointment.time) return;

        const doctor = this.currentAppointment.doctor;
        const date = new Date(this.currentAppointment.date);
        const time = this.currentAppointment.time;
        const reason = document.getElementById('visitReason');
        const selectedReason = reason.options[reason.selectedIndex].text;

        const formattedDateTime = date.toLocaleDateString('ar-EG', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
        });

        document.getElementById('paymentDoctor').textContent = doctor.name;
        document.getElementById('paymentDateTime').textContent = formattedDateTime;
        document.getElementById('paymentReason').textContent = selectedReason;
        document.getElementById('paymentAmount').textContent = doctor.price + ' Ø±.ÙŠ';

        // ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²
        const appointmentNumber = 'APT-' + new Date().getFullYear() + '-' + String(this.userAppointments.length + 1).padStart(3, '0');
        document.getElementById('appointmentNumber').textContent = appointmentNumber;
    }

    toggleInsuranceDetails(show) {
        const insuranceDetails = document.getElementById('insuranceDetails');
        insuranceDetails.style.display = show ? 'block' : 'none';
        
        if (show) {
            this.currentAppointment.insurance = {
                hasInsurance: true,
                company: '',
                policyNumber: ''
            };
        } else {
            this.currentAppointment.insurance = null;
        }
    }

    selectPaymentMethod(method) {
        this.currentAppointment.paymentMethod = method;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        document.querySelectorAll('.payment-method').forEach(m => {
            m.classList.remove('active');
        });
        
        event.target.closest('.payment-method').classList.add('active');
        
        // Ø¥Ø¸Ù‡Ø§Ø± ØªÙØ§ØµÙŠÙ„ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
        document.querySelectorAll('.payment-details').forEach(details => {
            details.style.display = 'none';
        });
        
        document.getElementById(`${method}Payment`).style.display = 'block';
    }

    loadPaymentMethods() {
        this.loadUserData();
        
        const walletSelect = document.getElementById('selectedWallet');
        const cardSelect = document.getElementById('selectedCard');
        
        walletSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­ÙØ¸Ø©</option>';
        cardSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</option>';
        
        this.userWallets.forEach(wallet => {
            walletSelect.innerHTML += `<option value="${wallet.id}">${wallet.name} - ${wallet.balance} Ø±.ÙŠ</option>`;
        });
        
        this.userCards.forEach(card => {
            cardSelect.innerHTML += `<option value="${card.id}">${card.processor} - ${card.lastFour}</option>`;
        });

        // ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©
        const walletBalance = document.getElementById('walletBalance');
        if (walletBalance && this.userAccount) {
            walletBalance.textContent = this.userAccount.balance + ' Ø±.ÙŠ';
        }

        // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ø­Ø§ÙØ¸ Ø£Ùˆ Ø¨Ø·Ø§Ù‚Ø§ØªØŒ Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
        if (this.userWallets.length === 0 && this.userCards.length === 0) {
            document.getElementById('selectedWallet').innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø­Ø§ÙØ¸ Ù…Ø±ØªØ¨Ø·Ø©</option>';
        }
    }

    handleFileUpload(files) {
        const fileList = document.getElementById('fileList');
        fileList.innerHTML = '';

        Array.from(files).slice(0, 5).forEach(file => {
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            fileItem.innerHTML = `
                <span class="file-name">${file.name}</span>
                <span class="file-remove" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </span>
            `;
            fileList.appendChild(fileItem);
            
            this.currentAppointment.attachments.push(file);
        });

        if (files.length > 5) {
            this.showNotification('ØªÙ… Ø±ÙØ¹ Ø£ÙˆÙ„ 5 Ù…Ù„ÙØ§Øª ÙÙ‚Ø·', 'warning');
        }
    }

    async confirmBooking() {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        if (!this.validateStep(4)) {
            this.showNotification('ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
            return;
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹
        if (this.currentAppointment.paymentMethod === 'wallet') {
            const selectedWallet = document.getElementById('selectedWallet').value;
            if (!selectedWallet) {
                this.showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©', 'error');
                return;
            }

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯
            if (this.userAccount.balance < this.currentAppointment.doctor.price) {
                this.showNotification('Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠØŒ ÙŠØ±Ø¬Ù‰ Ø´Ø­Ù† Ø§Ù„Ø­Ø³Ø§Ø¨', 'error');
                setTimeout(() => {
                    window.location.href = 'financial.html';
                }, 2000);
                return;
            }
        } else if (this.currentAppointment.paymentMethod === 'card') {
            const selectedCard = document.getElementById('selectedCard').value;
            if (!selectedCard) {
                this.showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©', 'error');
                return;
            }
        }

        this.showNotification('Ø¬Ø§Ø±ÙŠ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²...', 'info');

        try {
            const paymentResult = await this.processPayment();
            
            if (paymentResult.success) {
                this.finalizeAppointment(paymentResult);
            } else {
                this.showNotification(paymentResult.message, 'error');
            }
        } catch (error) {
            this.showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©', 'error');
        }
    }

    async processPayment() {
        return new Promise((resolve) => {
            setTimeout(() => {
                const success = Math.random() > 0.1; // 90% success rate
                
                if (success) {
                    resolve({
                        success: true,
                        transactionId: 'TXN' + Date.now(),
                        amount: this.currentAppointment.doctor.price,
                        method: this.currentAppointment.paymentMethod
                    });
                } else {
                    resolve({
                        success: false,
                        message: 'ÙØ´Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰'
                    });
                }
            }, 2000);
        });
    }

    finalizeAppointment(paymentResult) {
        const appointment = {
            id: Date.now(),
            number: document.getElementById('appointmentNumber').textContent,
            doctor: this.currentAppointment.doctor,
            date: this.currentAppointment.date,
            time: this.currentAppointment.time,
            reason: document.getElementById('visitReason').value,
            description: document.getElementById('conditionDescription').value,
            isFirstVisit: document.querySelector('input[name="firstVisit"]:checked').value,
            attachments: this.currentAppointment.attachments,
            insurance: this.currentAppointment.insurance,
            status: 'confirmed',
            createdAt: new Date().toISOString(),
            price: this.currentAppointment.doctor.price,
            payment: paymentResult,
            reminderSent: false
        };
        
        // ØªØ­Ø¯ÙŠØ« Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¯ÙØ¹ Ù…Ù† Ø§Ù„Ù…Ø­ÙØ¸Ø©
        if (this.currentAppointment.paymentMethod === 'wallet' && this.userAccount) {
            this.userAccount.balance -= appointment.price;
            localStorage.setItem('financialAccount', JSON.stringify(this.userAccount));
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯
        this.userAppointments.unshift(appointment);
        localStorage.setItem('userAppointments', JSON.stringify(this.userAppointments));
        
        // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¯ÙØ¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
        if (this.currentAppointment.paymentMethod !== 'cash') {
            this.addToTransactionHistory(appointment, paymentResult);
        }
        
        this.showNotification(`ØªÙ… Ø§Ù„Ø­Ø¬Ø² Ø¨Ù†Ø¬Ø§Ø­: ${appointment.price} Ø±.ÙŠ`, 'success');
        
        // Ø¹Ø±Ø¶ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²
        this.showConfirmationModal(appointment);
    }

    addToTransactionHistory(appointment, paymentResult) {
        const transactions = JSON.parse(localStorage.getItem('financialTransactions')) || [];
        
        const transaction = {
            id: paymentResult.transactionId,
            type: 'appointment',
            title: `Ù…ÙˆØ¹Ø¯ Ù…Ø¹ ${appointment.doctor.name}`,
            description: `ÙƒØ´Ù ${appointment.doctor.specialty} - ${appointment.reason}`,
            amount: -appointment.price,
            ref: appointment.number,
            date: new Date().toLocaleDateString('ar-EG'),
            time: new Date().toLocaleTimeString('ar-EG'),
            status: 'completed',
            icon: 'icon-appointment',
            method: paymentResult.method,
            doctor: appointment.doctor.name
        };
        
        transactions.unshift(transaction);
        localStorage.setItem('financialTransactions', JSON.stringify(transactions));
    }

    showConfirmationModal(appointment) {
        document.getElementById('finalAppointmentNumber').textContent = appointment.number;
        document.getElementById('finalDoctorName').textContent = appointment.doctor.name;
        
        const dateTime = new Date(appointment.date + 'T' + appointment.time);
        const formattedDateTime = dateTime.toLocaleDateString('ar-EG', { 
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
        });
        
        document.getElementById('finalAppointmentTime').textContent = formattedDateTime;
        document.getElementById('finalClinicAddress').textContent = appointment.doctor.clinic.address;
        
        openModal('confirmationModal');
    }

    showNotification(message, type = 'info') {
        // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
        const existingNotifications = document.querySelectorAll('.notification');
        existingNotifications.forEach(notification => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        });

        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.innerHTML = `
            <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
            ${message}
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 4000);
    }

    updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('ar-EG', { 
            hour: '2-digit', 
            minute: '2-digit',
            hour12: true 
        });
        
        const timeElement = document.getElementById('currentTime');
        if (timeElement) {
            timeElement.textContent = timeString;
        }
    }
}

// ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¹Ø§Ù…Ø©
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
}

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø¨Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡Ø§
document.addEventListener('click', function(event) {
    if (event.target.classList.contains('modal')) {
        event.target.style.display = 'none';
        document.body.style.overflow = 'auto';
    }
});

// Ù…Ù†Ø¹ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
document.addEventListener('DOMContentLoaded', function() {
    const forms = document.querySelectorAll('form');
    forms.forEach(form => {
        form.addEventListener('submit', function(e) {
            e.preventDefault();
        });
    });
});

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', function() {
    window.appointmentSystem = new DoctorAppointmentSystem();
    
    // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ±Ø§Øª ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ÙŠØ©
    setTimeout(() => {
        if (window.appointmentSystem) {
            window.appointmentSystem.showNotification('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù†Ø¸Ø§Ù… Ø­Ø¬Ø² Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯!', 'success');
        }
    }, 1000);
});

// Ø¬Ø¹Ù„ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø­Ø§Ù‹ globally
window.DoctorAppointmentSystem = DoctorAppointmentSystem;
</script>
</body>
</html>