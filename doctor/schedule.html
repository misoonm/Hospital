<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ø¨ÙŠØ¨ 24/7 - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700;800&family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©: Ø£Ø²Ø±Ù‚ Ø·Ø¨ÙŠ Ù‡Ø§Ø¯Ø¦ */
    --primary: #1976D2;
    --primary-dark: #1565C0;
    --primary-light: #BBDEFB;
    --secondary: #4CAF50;
    --accent: #FF5252;
    --success: #4CAF50;
    --warning: #FF9800;
    --info: #2196F3;

    /* Ø®Ù„ÙÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: ÙØ§ØªØ­Ø© ÙˆÙ…Ø±ÙŠØ­Ø© Ù„Ù„Ø¹ÙŠÙ† */
    --bg-light: #F5F9FF;
    --bg-surface: #ffffff;
    --shadow-light: -6px -6px 12px rgba(255, 255, 255, 0.9), 6px 6px 12px rgba(0, 0, 0, 0.08);
    --shadow-inset: inset 3px 3px 6px rgba(0, 0, 0, 0.1), inset -3px -3px 6px rgba(255, 255, 255, 0.9);
    --shadow-card: 0 10px 30px rgba(25, 118, 210, 0.15);
    --text-primary: #1E293B;
    --text-secondary: #475569;

    /* Ø§Ù„Ø²ÙˆØ§ÙŠØ§ ÙˆØ§Ù„Ø§Ù†ØªÙ‚Ø§Ù„Ø§Øª */
    --radius-xl: 30px;
    --radius-lg: 20px;
    --radius-md: 16px;
    --radius-sm: 12px;
    --transition-liquid: all 0.35s cubic-bezier(0.25, 0.8, 0.25, 1);

    /* Ø§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ù…Ø­Ø¯Ø«Ø© */
    --font-primary: 'IBM Plex Sans Arabic', 'Tajawal', sans-serif;
    --font-heading: 'Almarai', sans-serif;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: var(--font-primary);
    -webkit-tap-highlight-color: transparent;
}

body {
    background: var(--bg-light);
    color: var(--text-primary);
    direction: rtl;
    overflow-x: hidden;
    min-height: 100vh;
    font-size: 14px;
    line-height: 1.5;
}

/* Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
.ultra-app {
    max-width: 450px;
    min-height: 100vh;
    margin: 0 auto;
    background: var(--bg-light);
    position: relative;
    box-shadow: 0 0 40px rgba(0, 0, 0, 0.05);
    overflow-x: hidden;
}

/* Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© */
.status-bar {
    background: transparent;
    color: var(--text-primary);
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 12px;
    font-weight: 500;
    z-index: 1000;
}

/* Ø§Ù„Ù‡ÙŠØ¯Ø± */
.app-header {
    padding: 20px 16px 0;
}

.header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.title-section h1 {
    font-family: var(--font-heading);
    font-size: 22px;
    font-weight: 800;
    color: var(--primary-dark);
    margin-bottom: 4px;
}

.title-section p {
    font-size: 13px;
    color: var(--text-secondary);
}

/* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ */
.action-icon {
    background: var(--bg-light);
    box-shadow: var(--shadow-light);
    border: none;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary);
    cursor: pointer;
    transition: var(--transition-liquid);
    position: relative;
    font-size: 16px;
}

.action-icon:active {
    box-shadow: var(--shadow-inset);
    color: var(--primary-dark);
}

.icon-badge {
    position: absolute;
    top: 4px;
    right: 4px;
    background: var(--accent);
    color: white;
    border-radius: 50%;
    width: 14px;
    height: 14px;
    font-size: 9px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
}

/* Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© */
.search-filter-bar {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 18px;
}

.search-bar {
    background: var(--bg-light);
    box-shadow: var(--shadow-inset);
    padding: 10px 16px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    gap: 10px;
    flex: 1;
}

.search-input {
    flex: 1;
    border: none;
    background: transparent;
    font-size: 14px;
    color: var(--text-primary);
    outline: none;
    padding: 0;
}

.search-icon {
    color: var(--text-secondary);
    font-size: 14px;
}

.filter-btn {
    background: var(--bg-light);
    box-shadow: var(--shadow-light);
    border: none;
    width: 44px;
    height: 44px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary);
    cursor: pointer;
    transition: var(--transition-liquid);
    font-size: 14px;
}

.filter-btn:active {
    box-shadow: var(--shadow-inset);
}

/* Ù‚Ø³Ù… Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
.stats-section {
    padding: 0 16px 18px;
}

.stats-container {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
}

.stat-card {
    background: var(--bg-light);
    border-radius: var(--radius-lg);
    padding: 16px;
    box-shadow: var(--shadow-light);
    display: flex;
    align-items: center;
    gap: 12px;
    transition: var(--transition-liquid);
}

.stat-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-card);
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    color: white;
}

.stat-icon.total {
    background: linear-gradient(135deg, var(--primary), var(--primary-dark));
}

.stat-icon.pending {
    background: linear-gradient(135deg, var(--warning), #FFB74D);
}

.stat-icon.confirmed {
    background: linear-gradient(135deg, var(--success), #66BB6A);
}

.stat-icon.revenue {
    background: linear-gradient(135deg, #9C27B0, #BA68C8);
}

.stat-info {
    flex: 1;
}

.stat-value {
    font-size: 18px;
    font-weight: 800;
    margin-bottom: 4px;
    color: var(--text-primary);
}

.stat-label {
    font-size: 12px;
    color: var(--text-secondary);
}

/* Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª */
.tabs-section {
    padding: 0 16px 18px;
}

.tabs-container {
    display: flex;
    background: var(--bg-light);
    border-radius: var(--radius-lg);
    padding: 6px;
    box-shadow: var(--shadow-light);
    overflow-x: auto;
    scrollbar-width: none;
}

.tabs-container::-webkit-scrollbar {
    display: none;
}

.tab-btn {
    flex: 1;
    padding: 10px 12px;
    border: none;
    background: transparent;
    border-radius: var(--radius-md);
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
    cursor: pointer;
    transition: var(--transition-liquid);
    white-space: nowrap;
    min-width: 70px;
}

.tab-btn.active {
    background: var(--primary);
    color: white;
    box-shadow: var(--shadow-inset);
}

/* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
.main-content {
    padding: 0 16px 100px;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.section-header h2 {
    font-family: var(--font-heading);
    font-size: 18px;
    font-weight: 700;
    color: var(--text-primary);
}

.date-input {
    background: var(--bg-light);
    border: none;
    padding: 8px 12px;
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-inset);
    font-size: 13px;
    color: var(--text-primary);
    outline: none;
}

/* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ */
.appointments-container {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ÙˆØ¹Ø¯ */
.appointment-card {
    background: var(--bg-light);
    border-radius: var(--radius-lg);
    padding: 16px;
    box-shadow: var(--shadow-light);
    transition: var(--transition-liquid);
    border-right: 4px solid var(--primary);
    position: relative;
}

.appointment-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-card);
}

.appointment-card.pending {
    border-right-color: var(--warning);
}

.appointment-card.confirmed {
    border-right-color: var(--success);
}

.appointment-card.completed {
    border-right-color: var(--info);
}

.appointment-card.cancelled {
    border-right-color: var(--accent);
}

.appointment-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 12px;
}

.appointment-patient {
    display: flex;
    align-items: center;
    gap: 10px;
}

.patient-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--primary-light);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--primary);
    font-size: 16px;
    overflow: hidden;
}

.patient-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.patient-info {
    flex: 1;
}

.patient-name {
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 2px;
    font-size: 14px;
}

.visit-type {
    font-size: 12px;
    color: var(--text-secondary);
}

.appointment-status {
    padding: 4px 8px;
    border-radius: var(--radius-sm);
    font-size: 11px;
    font-weight: 600;
    color: white;
}

.status-pending {
    background: var(--warning);
}

.status-confirmed {
    background: var(--success);
}

.status-completed {
    background: var(--info);
}

.status-cancelled {
    background: var(--accent);
}

.appointment-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
    margin-bottom: 12px;
    padding-bottom: 12px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.appointment-detail {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: var(--text-secondary);
}

.appointment-detail i {
    width: 14px;
    color: var(--primary);
}

.appointment-fee {
    font-weight: 700;
    color: var(--success);
    font-size: 14px;
}

.appointment-actions {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
}

/* Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ */
.empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--text-secondary);
}

.empty-icon {
    font-size: 48px;
    color: var(--primary-light);
    margin-bottom: 16px;
}

.empty-state h3 {
    font-size: 18px;
    margin-bottom: 8px;
    color: var(--text-primary);
}

.empty-state p {
    font-size: 14px;
}

/* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
.bottom-nav-dock {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--bg-light);
    box-shadow: var(--shadow-light);
    display: flex;
    padding: 6px 8px;
    border-radius: var(--radius-xl);
    z-index: 1000;
    max-width: 340px;
    width: calc(100% - 32px);
    border: 1px solid rgba(255, 255, 255, 0.5);
}

.nav-item-dock {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 6px 0;
    border-radius: var(--radius-md);
    transition: var(--transition-liquid);
    flex: 1;
    position: relative;
    text-decoration: none;
    color: var(--text-secondary);
}

.nav-item-dock.active {
    color: var(--primary-dark);
}

.nav-item-dock.active .nav-icon-dock {
    background: var(--primary);
    color: white;
    box-shadow: 0 4px 15px rgba(25, 118, 210, 0.5);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    transform: translateY(-8px);
    transition: var(--transition-liquid);
}

.nav-icon-dock {
    font-size: 16px;
    margin-bottom: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    transition: var(--transition-liquid);
}

.nav-label {
    font-size: 9px;
    font-weight: 600;
    margin-top: 2px;
    transition: var(--transition-liquid);
}

.nav-item-dock.active .nav-label {
    font-weight: 800;
    color: var(--primary-dark);
}

/* Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    transition: opacity 0.3s ease-out;
    z-index: 2000;
}

.modal-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    border: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: var(--shadow-card);
    animation: modalSlideUp 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
    border-radius: var(--radius-xl) var(--radius-xl) 0 0;
    max-height: 85vh;
    overflow-y: auto;
}

@keyframes modalSlideUp {
    from {opacity: 0; transform: translateY(100%);}
    to {opacity: 1; transform: translateY(0);}
}

.modal-header {
    background: var(--primary);
    color: white;
    padding: 18px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: var(--radius-xl) var(--radius-xl) 0 0;
}

.modal-header h2 {
    margin: 0;
    font-size: 18px;
}

.close {
    font-size: 20px;
    cursor: pointer;
}

/* ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¹Ø¯ ÙÙŠ Ø§Ù„Ù†Ø§ÙØ°Ø© */
.appointment-detail-modal {
    padding: 18px;
}

.detail-section {
    background: var(--bg-light);
    border-radius: var(--radius-lg);
    padding: 16px;
    margin-bottom: 16px;
    box-shadow: var(--shadow-light);
}

.detail-section h3 {
    color: var(--primary);
    margin-bottom: 12px;
    font-size: 16px;
    border-bottom: 1px solid var(--primary-light);
    padding-bottom: 6px;
}

.detail-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}

.detail-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.detail-label {
    font-size: 12px;
    color: var(--text-secondary);
    font-weight: 600;
}

.detail-value {
    font-size: 14px;
    color: var(--text-primary);
    font-weight: 500;
}

.patient-notes {
    background: var(--bg-surface);
    padding: 12px;
    border-radius: var(--radius-md);
    margin-top: 8px;
    border-right: 3px solid var(--primary-light);
}

.notes-label {
    font-size: 12px;
    color: var(--text-secondary);
    margin-bottom: 6px;
    font-weight: 600;
}

.notes-content {
    font-size: 13px;
    color: var(--text-primary);
    line-height: 1.5;
}

/* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
.btn-primary {
    background: var(--primary);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: var(--radius-md);
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    transition: var(--transition-liquid);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
}

.btn-primary:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

.btn-secondary {
    background: var(--bg-light);
    color: var(--text-primary);
    border: none;
    padding: 10px 20px;
    border-radius: var(--radius-md);
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition-liquid);
    box-shadow: var(--shadow-light);
}

.btn-secondary:hover {
    box-shadow: var(--shadow-inset);
}

.btn-small {
    padding: 6px 12px;
    font-size: 12px;
}

.btn-success {
    background: var(--success);
    color: white;
}

.btn-warning {
    background: var(--warning);
    color: white;
}

.btn-danger {
    background: var(--accent);
    color: white;
}

/* Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ÙØµÙ„Ø© */
.stats-details {
    padding: 18px;
}

.stats-chart {
    background: var(--bg-light);
    border-radius: var(--radius-lg);
    padding: 16px;
    margin-bottom: 16px;
    box-shadow: var(--shadow-light);
}

.chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.chart-title {
    font-size: 16px;
    font-weight: 700;
    color: var(--text-primary);
}

.chart-period {
    font-size: 12px;
    color: var(--text-secondary);
}

.chart-container {
    height: 200px;
    position: relative;
    display: flex;
    align-items: flex-end;
    gap: 8px;
    padding: 10px 0;
}

.chart-bar {
    flex: 1;
    background: linear-gradient(to top, var(--primary), var(--primary-light));
    border-radius: var(--radius-sm) var(--radius-sm) 0 0;
    position: relative;
    min-height: 20px;
}

.chart-label {
    position: absolute;
    bottom: -20px;
    left: 0;
    right: 0;
    text-align: center;
    font-size: 10px;
    color: var(--text-secondary);
}

.stats-summary {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
}

.summary-card {
    background: var(--bg-light);
    border-radius: var(--radius-lg);
    padding: 16px;
    box-shadow: var(--shadow-light);
    text-align: center;
}

.summary-value {
    font-size: 24px;
    font-weight: 800;
    color: var(--primary);
    margin-bottom: 6px;
}

.summary-label {
    font-size: 12px;
    color: var(--text-secondary);
}

/* Ø§Ù„ØªØµÙÙŠØ© */
.filter-section {
    margin-bottom: 20px;
}

.filter-section h3 {
    margin-bottom: 10px;
    color: var(--primary);
    font-size: 14px;
}

.filter-options {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.filter-option {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    background: var(--bg-light);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: var(--transition-liquid);
    font-size: 13px;
}

.filter-option:hover {
    background: var(--primary-light);
}

.filter-option input {
    margin: 0;
    transform: scale(0.9);
}

.filter-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

/* Ø§Ù„ØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
@media (max-width: 428px) {
    .stats-container {
        grid-template-columns: 1fr;
    }
    
    .detail-grid {
        grid-template-columns: 1fr;
    }
    
    .appointment-details {
        grid-template-columns: 1fr;
    }
    
    .stats-summary {
        grid-template-columns: 1fr;
    }
    
    .status-bar {
        padding: 8px 16px;
    }
    
    .app-header {
        padding: 16px 12px 0;
    }
    
    .main-content {
        padding: 0 12px 90px;
    }
    
    .filter-actions {
        flex-direction: column;
    }
    
    .appointment-actions {
        flex-direction: column;
    }
}
</style>
</head>
<body>
    <div class="ultra-app">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© -->
        <div class="status-bar">
            <div class="status-left">
                <span id="currentTime">10:03 Ù…</span>
            </div>
            <div class="status-right">
                <i class="fas fa-signal"></i>
                <i class="fas fa-wifi"></i>
                <i class="fas fa-battery-full"></i>
            </div>
        </div>

        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="app-header">
            <div class="header-top">
                <div class="title-section">
                    <h1>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ ğŸ©º</h1>
                    <p>Ø¹Ø±Ø¶ ÙˆØ¥Ø¯Ø§Ø±Ø© Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø±Ø¶Ù‰</p>
                </div>
                <div class="doctor-actions">
                    <button class="action-icon" id="statsBtn">
                        <i class="fas fa-chart-bar"></i>
                    </button>
                    <button class="action-icon" id="walletBtn">
                        <i class="fas fa-wallet"></i>
                        <span class="icon-badge" id="walletBadge">0</span>
                    </button>
                </div>
            </div>
            
            <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ© -->
            <div class="search-filter-bar">
                <div class="search-bar">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø±ÙŠØ¶ØŒ ØªØ§Ø±ÙŠØ® Ø£Ùˆ Ø­Ø§Ù„Ø©..." id="searchInput">
                </div>
                <button class="filter-btn" id="filterBtn">
                    <i class="fas fa-filter"></i>
                </button>
            </div>
        </div>

        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
        <div class="stats-section">
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-icon total">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalAppointments">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon pending">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="pendingAppointments">0</div>
                        <div class="stat-label">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon confirmed">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="confirmedAppointments">0</div>
                        <div class="stat-label">Ù…Ø¤ÙƒØ¯Ø©</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon revenue">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-info">
                        <div class="stat-value" id="totalRevenue">0 Ø±.ÙŠ</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
        <div class="tabs-section">
            <div class="tabs-container">
                <button class="tab-btn active" data-tab="all">Ø§Ù„ÙƒÙ„</button>
                <button class="tab-btn" data-tab="pending">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</button>
                <button class="tab-btn" data-tab="confirmed">Ù…Ø¤ÙƒØ¯Ø©</button>
                <button class="tab-btn" data-tab="completed">Ù…ÙƒØªÙ…Ù„Ø©</button>
                <button class="tab-btn" data-tab="cancelled">Ù…Ù„ØºÙŠØ©</button>
            </div>
        </div>

        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="main-content">
            <div class="appointments-section">
                <div class="section-header">
                    <h2>Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„ÙŠÙˆÙ…</h2>
                    <div class="date-selector">
                        <input type="date" id="dateFilter" class="date-input">
                    </div>
                </div>

                <div class="appointments-container" id="appointmentsContainer">
                    <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                </div>

                <div class="empty-state" id="emptyState" style="display: none;">
                    <div class="empty-icon">
                        <i class="fas fa-calendar-times"></i>
                    </div>
                    <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯</h3>
                    <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù„Ø¹Ø±Ø¶Ù‡Ø§ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ®</p>
                </div>
            </div>
        </div>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ -->
        <div class="bottom-nav-dock">
            <a href="index.html" class="nav-item-dock">
                <div class="nav-icon-dock">
                    <i class="fas fa-home"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            </a>
            <a href="doctor-appointment.html" class="nav-item-dock">
                <div class="nav-icon-dock">
                    <i class="fas fa-user-md"></i>
                </div>
                <div class="nav-label">Ø­Ø¬Ø² Ø¯ÙƒØªÙˆØ±</div>
            </a>
            <a href="appointments.html" class="nav-item-dock active">
                <div class="nav-icon-dock">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="nav-label">Ù…ÙˆØ§Ø¹ÙŠØ¯ÙŠ</div>
            </a>
            <a href="financial.html" class="nav-item-dock">
                <div class="nav-icon-dock">
                    <i class="fas fa-wallet"></i>
                </div>
                <div class="nav-label">Ø§Ù„Ù…Ø­ÙØ¸Ø©</div>
            </a>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¹Ø¯ -->
    <div id="appointmentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="appointmentModalTitle">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¹Ø¯</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="appointmentModalBody">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
    <div id="statsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body" id="statsModalBody">
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØµÙÙŠØ© -->
    <div id="filterModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ØªØµÙÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="filter-section">
                    <h3>Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¹Ø¯</h3>
                    <div class="filter-options" id="statusFilter">
                        <label class="filter-option">
                            <input type="checkbox" value="pending" checked>
                            <span>ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" value="confirmed" checked>
                            <span>Ù…Ø¤ÙƒØ¯Ø©</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" value="completed" checked>
                            <span>Ù…ÙƒØªÙ…Ù„Ø©</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" value="cancelled">
                            <span>Ù…Ù„ØºÙŠØ©</span>
                        </label>
                    </div>
                </div>
                <div class="filter-section">
                    <h3>Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</h3>
                    <div class="filter-options" id="visitTypeFilter">
                        <label class="filter-option">
                            <input type="checkbox" value="ÙƒØ´Ù" checked>
                            <span>ÙƒØ´Ù Ø¹Ø§Ø¯ÙŠ</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" value="Ù…ØªØ§Ø¨Ø¹Ø©" checked>
                            <span>Ù…ØªØ§Ø¨Ø¹Ø©</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" value="Ø§Ø³ØªØ´Ø§Ø±Ø©" checked>
                            <span>Ø§Ø³ØªØ´Ø§Ø±Ø©</span>
                        </label>
                        <label class="filter-option">
                            <input type="checkbox" value="Ø·ÙˆØ§Ø±Ø¦" checked>
                            <span>Ø·ÙˆØ§Ø±Ø¦</span>
                        </label>
                    </div>
                </div>
                <div class="filter-actions">
                    <button class="btn-secondary" id="resetFilters">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†</button>
                    <button class="btn-primary" id="applyFilters">ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØµÙÙŠØ©</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù„Ù„Ø·Ø¨ÙŠØ¨
class DoctorAppointmentsManager {
    constructor() {
        this.appointments = [];
        this.filteredAppointments = [];
        this.currentTab = 'all';
        this.currentDate = new Date().toISOString().split('T')[0];
        this.filters = {
            status: ['pending', 'confirmed', 'completed'],
            visitType: ['ÙƒØ´Ù', 'Ù…ØªØ§Ø¨Ø¹Ø©', 'Ø§Ø³ØªØ´Ø§Ø±Ø©', 'Ø·ÙˆØ§Ø±Ø¦']
        };
        this.doctorId = 'DOC-001'; // ÙŠÙ…ÙƒÙ† Ø¬Ù„Ø¨Ù‡Ø§ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        this.doctorName = 'Ø¯. ÙŠØ§Ø³Ø± Ø¹Ø¨Ø§Ø³'; // ÙŠÙ…ÙƒÙ† Ø¬Ù„Ø¨Ù‡Ø§ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        this.init();
    }

    init() {
        this.loadAppointments();
        this.setupEventListeners();
        this.updateStats();
        this.renderAppointments();
        this.updateTime();
        this.updateWalletBalance();
    }

    loadAppointments() {
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù…Ù† localStorage Ø£Ùˆ Ù…Ù† API
        const savedAppointments = localStorage.getItem('doctor_appointments_bookings');
        
        if (savedAppointments) {
            const allAppointments = JSON.parse(savedAppointments);
            // ØªØµÙÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø·Ø¨ÙŠØ¨ ÙÙ‚Ø·
            this.appointments = allAppointments.filter(appointment => 
                appointment.doctorId === this.doctorId || 
                appointment.doctorName === this.doctorName
            );
        } else {
            // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø·Ø¨ÙŠØ¨
            this.appointments = this.getSampleAppointments();
            this.saveAppointments();
        }
        
        this.applyFilters();
    }

    getSampleAppointments() {
        return [
            {
                id: 1,
                doctorId: 'DOC-001',
                doctorName: 'Ø¯. ÙŠØ§Ø³Ø± Ø¹Ø¨Ø§Ø³',
                doctorSpecialty: 'Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù…Ø³Ø§Ù„Ùƒ Ø§Ù„Ø¨ÙˆÙ„ÙŠØ©',
                patientName: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',
                patientId: 'PAT-001',
                patientPhone: '0551234567',
                patientEmail: 'ahmed@example.com',
                date: new Date().toISOString().split('T')[0],
                time: '10:00',
                visitType: 'ÙƒØ´Ù',
                notes: 'ÙŠØ´ÙƒÙˆ Ù…Ù† Ø¢Ù„Ø§Ù… ÙÙŠ Ø§Ù„Ø¸Ù‡Ø±',
                status: 'pending',
                paymentMethod: 'Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©',
                fee: 200,
                transactionId: 'TRX-001',
                createdAt: new Date().toISOString()
            },
            {
                id: 2,
                doctorId: 'DOC-001',
                doctorName: 'Ø¯. ÙŠØ§Ø³Ø± Ø¹Ø¨Ø§Ø³',
                doctorSpecialty: 'Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù…Ø³Ø§Ù„Ùƒ Ø§Ù„Ø¨ÙˆÙ„ÙŠØ©',
                patientName: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ',
                patientId: 'PAT-002',
                patientPhone: '0557654321',
                patientEmail: 'fatima@example.com',
                date: new Date().toISOString().split('T')[0],
                time: '11:30',
                visitType: 'Ù…ØªØ§Ø¨Ø¹Ø©',
                notes: 'Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©',
                status: 'confirmed',
                paymentMethod: 'Ù†Ù‚Ø¯ÙŠ',
                fee: 150,
                transactionId: 'TRX-002',
                createdAt: new Date(Date.now() - 86400000).toISOString()
            },
            {
                id: 3,
                doctorId: 'DOC-001',
                doctorName: 'Ø¯. ÙŠØ§Ø³Ø± Ø¹Ø¨Ø§Ø³',
                doctorSpecialty: 'Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù…Ø³Ø§Ù„Ùƒ Ø§Ù„Ø¨ÙˆÙ„ÙŠØ©',
                patientName: 'Ø®Ø§Ù„Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡',
                patientId: 'PAT-003',
                patientPhone: '0551112233',
                patientEmail: 'khaled@example.com',
                date: new Date(Date.now() + 86400000).toISOString().split('T')[0],
                time: '09:00',
                visitType: 'Ø§Ø³ØªØ´Ø§Ø±Ø©',
                notes: 'Ø§Ø³ØªØ´Ø§Ø±Ø© Ø­ÙˆÙ„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„',
                status: 'confirmed',
                paymentMethod: 'Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†',
                fee: 180,
                transactionId: 'TRX-003',
                createdAt: new Date().toISOString()
            },
            {
                id: 4,
                doctorId: 'DOC-001',
                doctorName: 'Ø¯. ÙŠØ§Ø³Ø± Ø¹Ø¨Ø§Ø³',
                doctorSpecialty: 'Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù…Ø³Ø§Ù„Ùƒ Ø§Ù„Ø¨ÙˆÙ„ÙŠØ©',
                patientName: 'Ø³Ø§Ø±Ø© Ø£Ø­Ù…Ø¯',
                patientId: 'PAT-004',
                patientPhone: '0554445566',
                patientEmail: 'sara@example.com',
                date: new Date(Date.now() - 172800000).toISOString().split('T')[0],
                time: '14:00',
                visitType: 'ÙƒØ´Ù',
                notes: 'ÙØ­Øµ Ø¯ÙˆØ±ÙŠ',
                status: 'completed',
                paymentMethod: 'Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©',
                fee: 200,
                transactionId: 'TRX-004',
                createdAt: new Date(Date.now() - 259200000).toISOString()
            }
        ];
    }

    saveAppointments() {
        // Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ ÙÙŠ localStorage
        const allAppointments = JSON.parse(localStorage.getItem('doctor_appointments_bookings')) || [];
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø·Ø¨ÙŠØ¨ ÙÙ‚Ø·
        const otherAppointments = allAppointments.filter(appointment => 
            appointment.doctorId !== this.doctorId && 
            appointment.doctorName !== this.doctorName
        );
        
        const updatedAppointments = [...otherAppointments, ...this.appointments];
        localStorage.setItem('doctor_appointments_bookings', JSON.stringify(updatedAppointments));
    }

    setupEventListeners() {
        // Ø§Ù„Ø¨Ø­Ø«
        document.getElementById('searchInput').addEventListener('input', (e) => {
            this.searchAppointments(e.target.value);
        });

        // Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                this.changeTab(e.target.dataset.tab);
            });
        });

        // ØªØµÙÙŠØ© Ø§Ù„ØªØ§Ø±ÙŠØ®
        document.getElementById('dateFilter').addEventListener('change', (e) => {
            this.currentDate = e.target.value;
            this.applyFilters();
            this.renderAppointments();
        });

        // Ø²Ø± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        document.getElementById('statsBtn').addEventListener('click', () => {
            this.showStatsModal();
        });

        // Ø²Ø± Ø§Ù„Ù…Ø­ÙØ¸Ø©
        document.getElementById('walletBtn').addEventListener('click', () => {
            window.location.href = 'financial.html';
        });

        // Ø§Ù„ØªØµÙÙŠØ©
        document.getElementById('filterBtn').addEventListener('click', () => {
            this.showFilterModal();
        });

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†ÙˆØ§ÙØ°
        document.querySelectorAll('.close').forEach(closeBtn => {
            closeBtn.addEventListener('click', function() {
                this.closest('.modal').style.display = 'none';
            });
        });

        // Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†ÙˆØ§ÙØ°
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
        setInterval(() => this.updateTime(), 60000);

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØµÙÙŠØ©
        document.getElementById('applyFilters').addEventListener('click', () => {
            this.applyUserFilters();
        });

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØµÙÙŠØ©
        document.getElementById('resetFilters').addEventListener('click', () => {
            this.resetFilters();
        });
    }

    updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString('ar-EG', { 
            hour: '2-digit', 
            minute: '2-digit',
            hour12: true 
        });
        document.getElementById('currentTime').textContent = timeString;
    }

    updateStats() {
        const total = this.appointments.length;
        const pending = this.appointments.filter(a => a.status === 'pending').length;
        const confirmed = this.appointments.filter(a => a.status === 'confirmed').length;
        const revenue = this.appointments
            .filter(a => a.status === 'completed' || a.status === 'confirmed')
            .reduce((sum, a) => sum + a.fee, 0);

        document.getElementById('totalAppointments').textContent = total;
        document.getElementById('pendingAppointments').textContent = pending;
        document.getElementById('confirmedAppointments').textContent = confirmed;
        document.getElementById('totalRevenue').textContent = `${revenue} Ø±.ÙŠ`;
    }

    updateWalletBalance() {
        const financialAccount = JSON.parse(localStorage.getItem('financialAccount')) || { balance: 0 };
        document.getElementById('walletBadge').textContent = financialAccount.balance;
    }

    searchAppointments(query) {
        const searchTerm = query.toLowerCase();
        if (searchTerm.trim() === '') {
            this.applyFilters();
        } else {
            this.filteredAppointments = this.filteredAppointments.filter(appointment => 
                appointment.patientName.toLowerCase().includes(searchTerm) ||
                appointment.patientPhone.includes(searchTerm) ||
                appointment.visitType.toLowerCase().includes(searchTerm) ||
                appointment.status.toLowerCase().includes(searchTerm)
            );
        }
        this.renderAppointments();
    }

    changeTab(tab) {
        this.currentTab = tab;
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
        this.applyFilters();
        this.renderAppointments();
    }

    applyFilters() {
        let filtered = [...this.appointments];

        // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
        if (this.currentTab !== 'all') {
            filtered = filtered.filter(appointment => appointment.status === this.currentTab);
        }

        // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
        filtered = filtered.filter(appointment => appointment.date === this.currentDate);

        // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
        filtered = filtered.filter(appointment => this.filters.status.includes(appointment.status));

        // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©
        filtered = filtered.filter(appointment => this.filters.visitType.includes(appointment.visitType));

        this.filteredAppointments = filtered;
    }

    applyUserFilters() {
        // Ø¬Ù…Ø¹ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
        this.filters.status = Array.from(document.querySelectorAll('#statusFilter input:checked'))
            .map(input => input.value);

        // Ø¬Ù…Ø¹ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
        this.filters.visitType = Array.from(document.querySelectorAll('#visitTypeFilter input:checked'))
            .map(input => input.value);

        this.applyFilters();
        this.renderAppointments();
        document.getElementById('filterModal').style.display = 'none';
    }

    resetFilters() {
        this.filters = {
            status: ['pending', 'confirmed', 'completed'],
            visitType: ['ÙƒØ´Ù', 'Ù…ØªØ§Ø¨Ø¹Ø©', 'Ø§Ø³ØªØ´Ø§Ø±Ø©', 'Ø·ÙˆØ§Ø±Ø¦']
        };
        document.querySelectorAll('#statusFilter input').forEach(input => {
            input.checked = ['pending', 'confirmed', 'completed'].includes(input.value);
        });
        document.querySelectorAll('#visitTypeFilter input').forEach(input => {
            input.checked = true;
        });
    }

    renderAppointments() {
        const container = document.getElementById('appointmentsContainer');
        const emptyState = document.getElementById('emptyState');

        if (this.filteredAppointments.length === 0) {
            container.style.display = 'none';
            emptyState.style.display = 'block';
            return;
        }

        container.style.display = 'block';
        emptyState.style.display = 'none';

        let appointmentsHTML = '';

        this.filteredAppointments.forEach(appointment => {
            const statusClass = appointment.status;
            const statusText = {
                'pending': 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
                'confirmed': 'Ù…Ø¤ÙƒØ¯Ø©',
                'completed': 'Ù…ÙƒØªÙ…Ù„Ø©',
                'cancelled': 'Ù…Ù„ØºÙŠØ©'
            }[appointment.status] || 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±';

            appointmentsHTML += `
                <div class="appointment-card ${statusClass}" onclick="doctorAppointmentsManager.showAppointmentDetails(${appointment.id})">
                    <div class="appointment-header">
                        <div class="appointment-patient">
                            <div class="patient-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="patient-info">
                                <div class="patient-name">${appointment.patientName}</div>
                                <div class="visit-type">${appointment.visitType}</div>
                            </div>
                        </div>
                        <div class="appointment-status status-${statusClass}">${statusText}</div>
                    </div>
                    <div class="appointment-details">
                        <div class="appointment-detail">
                            <i class="fas fa-calendar"></i>
                            ${appointment.date}
                        </div>
                        <div class="appointment-detail">
                            <i class="fas fa-clock"></i>
                            ${appointment.time}
                        </div>
                        <div class="appointment-detail">
                            <i class="fas fa-phone"></i>
                            ${appointment.patientPhone}
                        </div>
                        <div class="appointment-detail">
                            <i class="fas fa-money-bill"></i>
                            ${appointment.fee} Ø±.ÙŠ
                        </div>
                    </div>
                    <div class="appointment-actions">
                        ${appointment.status === 'pending' ? `
                            <button class="btn-primary btn-small" onclick="event.stopPropagation(); doctorAppointmentsManager.confirmAppointment(${appointment.id})">
                                <i class="fas fa-check"></i>
                                ØªØ£ÙƒÙŠØ¯
                            </button>
                            <button class="btn-danger btn-small" onclick="event.stopPropagation(); doctorAppointmentsManager.cancelAppointment(${appointment.id})">
                                <i class="fas fa-times"></i>
                                Ø±ÙØ¶
                            </button>
                        ` : ''}
                        ${appointment.status === 'confirmed' ? `
                            <button class="btn-success btn-small" onclick="event.stopPropagation(); doctorAppointmentsManager.completeAppointment(${appointment.id})">
                                <i class="fas fa-check-double"></i>
                                Ø¥ÙƒÙ…Ø§Ù„
                            </button>
                            <button class="btn-danger btn-small" onclick="event.stopPropagation(); doctorAppointmentsManager.cancelAppointment(${appointment.id})">
                                <i class="fas fa-times"></i>
                                Ø¥Ù„ØºØ§Ø¡
                            </button>
                        ` : ''}
                        ${appointment.status === 'completed' ? `
                            <button class="btn-secondary btn-small" onclick="event.stopPropagation(); doctorAppointmentsManager.addToWallet(${appointment.id})">
                                <i class="fas fa-wallet"></i>
                                Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…Ø­ÙØ¸Ø©
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
        });

        container.innerHTML = appointmentsHTML;
    }

    showAppointmentDetails(appointmentId) {
        const appointment = this.appointments.find(a => a.id === appointmentId);
        if (!appointment) return;

        const modal = document.getElementById('appointmentModal');
        document.getElementById('appointmentModalTitle').textContent = `ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¹Ø¯ - ${appointment.patientName}`;

        const statusText = {
            'pending': 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
            'confirmed': 'Ù…Ø¤ÙƒØ¯Ø©',
            'completed': 'Ù…ÙƒØªÙ…Ù„Ø©',
            'cancelled': 'Ù…Ù„ØºÙŠØ©'
        }[appointment.status] || 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±';

        const modalBody = document.getElementById('appointmentModalBody');
        modalBody.innerHTML = `
            <div class="appointment-detail-modal">
                <div class="detail-section">
                    <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶</h3>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</div>
                            <div class="detail-value">${appointment.patientName}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</div>
                            <div class="detail-value">${appointment.patientPhone}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</div>
                            <div class="detail-value">${appointment.patientEmail}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ø±Ù‚Ù… Ø§Ù„Ù…Ø±ÙŠØ¶</div>
                            <div class="detail-value">${appointment.patientId}</div>
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¹Ø¯</h3>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">Ø§Ù„ØªØ§Ø±ÙŠØ®</div>
                            <div class="detail-value">${appointment.date}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ø§Ù„ÙˆÙ‚Øª</div>
                            <div class="detail-value">${appointment.time}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</div>
                            <div class="detail-value">${appointment.visitType}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ø§Ù„Ø­Ø§Ù„Ø©</div>
                            <div class="detail-value">${statusText}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</div>
                            <div class="detail-value">${appointment.paymentMethod}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ø±Ø³ÙˆÙ… Ø§Ù„ÙƒØ´Ù</div>
                            <div class="detail-value">${appointment.fee} Ø±.ÙŠ</div>
                        </div>
                    </div>
                </div>

                ${appointment.notes ? `
                <div class="detail-section">
                    <h3>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø±ÙŠØ¶</h3>
                    <div class="patient-notes">
                        <div class="notes-label">Ù…Ø§ Ø°ÙƒØ±Ù‡ Ø§Ù„Ù…Ø±ÙŠØ¶:</div>
                        <div class="notes-content">${appointment.notes}</div>
                    </div>
                </div>
                ` : ''}

                <div class="appointment-actions" style="margin-top: 20px;">
                    ${appointment.status === 'pending' ? `
                        <button class="btn-primary" onclick="doctorAppointmentsManager.confirmAppointment(${appointment.id})">
                            <i class="fas fa-check"></i>
                            ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆØ¹Ø¯
                        </button>
                        <button class="btn-danger" onclick="doctorAppointmentsManager.cancelAppointment(${appointment.id})">
                            <i class="fas fa-times"></i>
                            Ø±ÙØ¶ Ø§Ù„Ù…ÙˆØ¹Ø¯
                        </button>
                    ` : ''}
                    ${appointment.status === 'confirmed' ? `
                        <button class="btn-success" onclick="doctorAppointmentsManager.completeAppointment(${appointment.id})">
                            <i class="fas fa-check-double"></i>
                            Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯
                        </button>
                        <button class="btn-danger" onclick="doctorAppointmentsManager.cancelAppointment(${appointment.id})">
                            <i class="fas fa-times"></i>
                            Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…ÙˆØ¹Ø¯
                        </button>
                    ` : ''}
                    ${appointment.status === 'completed' ? `
                        <button class="btn-primary" onclick="doctorAppointmentsManager.addToWallet(${appointment.id})">
                            <i class="fas fa-wallet"></i>
                            Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ø­ÙØ¸Ø©
                        </button>
                    ` : ''}
                </div>
            </div>
        `;

        modal.style.display = 'block';
    }

    confirmAppointment(appointmentId) {
        const appointment = this.appointments.find(a => a.id === appointmentId);
        if (!appointment) return;

        appointment.status = 'confirmed';
        this.saveAppointments();
        this.updateStats();
        this.applyFilters();
        this.renderAppointments();
        document.getElementById('appointmentModal').style.display = 'none';
        
        alert('ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù†Ø¬Ø§Ø­!');
    }

    completeAppointment(appointmentId) {
        const appointment = this.appointments.find(a => a.id === appointmentId);
        if (!appointment) return;

        appointment.status = 'completed';
        this.saveAppointments();
        this.updateStats();
        this.applyFilters();
        this.renderAppointments();
        document.getElementById('appointmentModal').style.display = 'none';
        
        alert('ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ø¥Ù„Ù‰ Ù…Ø­ÙØ¸ØªÙƒ.');
    }

    cancelAppointment(appointmentId) {
        if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ù„ØºØ§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆØ¹Ø¯ØŸ')) return;

        const appointment = this.appointments.find(a => a.id === appointmentId);
        if (!appointment) return;

        appointment.status = 'cancelled';
        this.saveAppointments();
        this.updateStats();
        this.applyFilters();
        this.renderAppointments();
        document.getElementById('appointmentModal').style.display = 'none';
        
        alert('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø¨Ù†Ø¬Ø§Ø­!');
    }

    addToWallet(appointmentId) {
        const appointment = this.appointments.find(a => a.id === appointmentId);
        if (!appointment || appointment.status !== 'completed') {
            alert('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ø­ÙØ¸Ø©. ÙŠØ¬Ø¨ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø£ÙˆÙ„Ø§Ù‹.');
            return;
        }

        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ø³Ø¨Ù‚Ø§Ù‹
        if (appointment.addedToWallet) {
            alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ø­ÙØ¸Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹.');
            return;
        }

        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ù…Ø­ÙØ¸Ø©
        const financialAccount = JSON.parse(localStorage.getItem('financialAccount')) || { balance: 0 };
        financialAccount.balance += appointment.fee;
        localStorage.setItem('financialAccount', JSON.stringify(financialAccount));

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©
        const financialTransactions = JSON.parse(localStorage.getItem('financialTransactions')) || [];
        const transaction = {
            id: 'DR' + Date.now().toString().slice(-8),
            type: 'deposit',
            title: `Ø­Ø¬Ø² Ù…ÙˆØ¹Ø¯ - ${appointment.patientName}`,
            description: `Ø±Ø³ÙˆÙ… ÙƒØ´Ù Ø·Ø¨ÙŠ - ${appointment.visitType}`,
            amount: appointment.fee,
            ref: appointment.transactionId || 'N/A',
            date: new Date().toLocaleDateString('ar-EG'),
            time: new Date().toLocaleTimeString('ar-EG'),
            status: 'completed',
            icon: 'icon-appointment'
        };
        
        financialTransactions.unshift(transaction);
        localStorage.setItem('financialTransactions', JSON.stringify(financialTransactions));

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø·
        const financialActivities = JSON.parse(localStorage.getItem('financialActivities')) || [];
        const activity = {
            id: Date.now(),
            type: 'deposit',
            title: `Ø¥ÙŠØ±Ø§Ø¯ Ù…ÙˆØ¹Ø¯ - ${appointment.patientName}`,
            amount: appointment.fee,
            time: 'Ø§Ù„Ø¢Ù†',
            icon: 'fa-calendar-check'
        };
        
        financialActivities.unshift(activity);
        if (financialActivities.length > 10) {
            financialActivities.pop();
        }
        localStorage.setItem('financialActivities', JSON.stringify(financialActivities));

        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…ÙˆØ¹Ø¯
        appointment.addedToWallet = true;
        this.saveAppointments();
        this.updateWalletBalance();
        
        alert(`ØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù„Øº ${appointment.fee} Ø±.ÙŠ Ø¥Ù„Ù‰ Ù…Ø­ÙØ¸ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­!`);
        document.getElementById('appointmentModal').style.display = 'none';
    }

    showStatsModal() {
        const modal = document.getElementById('statsModal');
        const modalBody = document.getElementById('statsModalBody');

        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        const totalAppointments = this.appointments.length;
        const completedAppointments = this.appointments.filter(a => a.status === 'completed').length;
        const cancelledAppointments = this.appointments.filter(a => a.status === 'cancelled').length;
        const totalRevenue = this.appointments
            .filter(a => a.status === 'completed')
            .reduce((sum, a) => sum + a.fee, 0);
        
        // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©
        const visitTypeStats = {};
        this.appointments.forEach(appointment => {
            if (!visitTypeStats[appointment.visitType]) {
                visitTypeStats[appointment.visitType] = 0;
            }
            visitTypeStats[appointment.visitType]++;
        });

        // ØªÙˆÙ„ÙŠØ¯ Ù…Ø®Ø·Ø· Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
        const chartBars = Object.entries(visitTypeStats).map(([type, count]) => {
            const percentage = (count / totalAppointments) * 100;
            return `
                <div class="chart-bar" style="height: ${percentage}%">
                    <div class="chart-label">${type}</div>
                </div>
            `;
        }).join('');

        modalBody.innerHTML = `
            <div class="stats-details">
                <div class="stats-chart">
                    <div class="chart-header">
                        <div class="chart-title">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</div>
                        <div class="chart-period">Ø¢Ø®Ø± 30 ÙŠÙˆÙ…</div>
                    </div>
                    <div class="chart-container">
                        ${chartBars}
                    </div>
                </div>

                <div class="stats-summary">
                    <div class="summary-card">
                        <div class="summary-value">${totalAppointments}</div>
                        <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ§Ø¹ÙŠØ¯</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${completedAppointments}</div>
                        <div class="summary-label">Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù…ÙƒØªÙ…Ù„Ø©</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${cancelledAppointments}</div>
                        <div class="summary-label">Ù…ÙˆØ§Ø¹ÙŠØ¯ Ù…Ù„ØºÙŠØ©</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-value">${totalRevenue} Ø±.ÙŠ</div>
                        <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                    </div>
                </div>

                <div class="detail-section" style="margin-top: 20px;">
                    <h3>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <div class="detail-label">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
                            <div class="detail-value">${totalRevenue} Ø±.ÙŠ</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ù…ØªÙˆØ³Ø· Ø³Ø¹Ø± Ø§Ù„ÙƒØ´Ù</div>
                            <div class="detail-value">${completedAppointments > 0 ? Math.round(totalRevenue / completedAppointments) : 0} Ø±.ÙŠ</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù„ØºØ§Ø¡</div>
                            <div class="detail-value">${totalAppointments > 0 ? Math.round((cancelledAppointments / totalAppointments) * 100) : 0}%</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¥Ø´ØºØ§Ù„</div>
                            <div class="detail-value">${totalAppointments > 0 ? Math.round((completedAppointments / totalAppointments) * 100) : 0}%</div>
                        </div>
                    </div>
                </div>
            </div>
        `;

        modal.style.display = 'block';
    }

    showFilterModal() {
        const modal = document.getElementById('filterModal');
        modal.style.display = 'block';
    }
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
document.addEventListener('DOMContentLoaded', function() {
    window.doctorAppointmentsManager = new DoctorAppointmentsManager();
    
    // ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ
    document.getElementById('dateFilter').value = new Date().toISOString().split('T')[0];
});
    </script>
</body>
</html>
